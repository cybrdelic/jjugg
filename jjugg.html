<!DOCTYPE html>
<html lang="en" data-theme="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>jjugg - Job Tracker</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Space+Mono&display=swap"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.1/dist/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3-sankey@0.12.3/dist/d3-sankey.min.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        /* Root Variables for Theming */
        :root {
            --bg-primary: #000000;
            --bg-secondary: #0a0a0a;
            --bg-tertiary: rgba(20, 20, 20, 0.7);
            --accent-primary: #00f0ff;
            --accent-secondary: #9d00ff;
            --accent-tertiary: #ff2a6d;
            --accent-quaternary: #05ffa1;
            --accent-highlight: #ff00ff;
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.7);
            --text-tertiary: rgba(255, 255, 255, 0.4);
            --border-thin: 1px solid rgba(255, 255, 255, 0.05);
            --border-medium: 1px solid rgba(255, 255, 255, 0.1);
            --glass-bg: rgba(15, 15, 15, 0.6);
            --glass-border: rgba(255, 255, 255, 0.05);
            --status-applied: #2196F3;
            --status-interview: #FF9800;
            --status-offer: #4CAF50;
            --status-rejected: #F44336;
            --neon-glow: 0 0 10px var(--accent-primary), 0 0 20px var(--accent-primary), 0 0 30px var(--accent-primary);
            --neon-glow-intense: 0 0 10px var(--accent-highlight), 0 0 20px var(--accent-highlight), 0 0 30px var(--accent-highlight);
            --theme-transition: all 0.3s ease;
            --sidebar-width: 230px;
            --header-height: 60px;
            --cyber-grid: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'%3E%3Cpath stroke='%2300f0ff' stroke-width='0.2' fill='none' d='M0,0 L100,0 L100,100 L0,100 Z' /%3E%3Cpath stroke='%2300f0ff' stroke-width='0.1' fill='none' d='M50,0 L50,100 M0,50 L100,50' /%3E%3C/svg%3E");
        }

        /* Light Theme Overrides */
        [data-theme="light"] {
            --bg-primary: #f5f5f7;
            --bg-secondary: #ffffff;
            --bg-tertiary: rgba(240, 240, 245, 0.9);
            --accent-primary: #0066cc;
            --accent-secondary: #8c43ff;
            --text-primary: #000000;
            --text-secondary: rgba(0, 0, 0, 0.7);
            --text-tertiary: rgba(0, 0, 0, 0.4);
            --border-thin: 1px solid rgba(0, 0, 0, 0.05);
            --border-medium: 1px solid rgba(0, 0, 0, 0.1);
            --glass-bg: rgba(255, 255, 255, 0.8);
            --glass-border: rgba(0, 0, 0, 0.05);
        }

        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: var(--theme-transition);
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-primary);
            background-image:
                linear-gradient(0deg, rgba(0, 0, 0, 0.9) 0%, rgba(0, 0, 0, 0.7) 100%),
                url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%23ffffff' fill-opacity='0.03'%3E%3Cpath d='M0 0h25v25H0zM25 0h25v25H25zM50 0h25v25H50zM75 0h25v25H75zM0 25h25v25H0zM25 25h25v25H25zM50 25h25v25H50zM75 25h25v25H75zM0 50h25v25H0zM25 50h25v25H25zM50 50h25v25H50zM75 50h25v25H75zM0 75h25v25H0zM25 75h25v25H25zM50 75h25v25H50zM75 75h25v25H75z'/%3E%3C/g%3E%3C/svg%3E");
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.6;
            overflow-x: hidden;
        }

        [data-theme="light"] body {
            background-image:
                linear-gradient(0deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 255, 255, 0.7) 100%),
                url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%23000000' fill-opacity='0.03'%3E%3Cpath d='M0 0h25v25H0zM25 0h25v25H25zM50 0h25v25H50zM75 0h25v25H75zM0 25h25v25H0zM25 25h25v25H25zM50 25h25v25H50zM75 25h25v25H75zM0 50h25v25H0zM25 50h25v25H25zM50 50h25v25H50zM75 50h25v25H75zM0 75h25v25H0zM25 75h25v25H25zM50 75h25v25H50zM75 75h25v25H75z'/%3E%3C/g%3E%3C/svg%3E");
        }

        /* Background Overlay */
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image:
                linear-gradient(0deg, transparent 0%, transparent 99%, rgba(255, 255, 255, 0.04) 100%),
                linear-gradient(90deg, transparent 0%, transparent 99%, rgba(255, 255, 255, 0.04) 100%);
            background-size: 20px 20px;
            pointer-events: none;
            z-index: -1;
        }

        [data-theme="light"] body::before {
            background-image:
                linear-gradient(0deg, transparent 0%, transparent 99%, rgba(0, 0, 0, 0.04) 100%),
                linear-gradient(90deg, transparent 0%, transparent 99%, rgba(0, 0, 0, 0.04) 100%);
        }

        /* Updated Header Styles - Shorter and More Appealing */
        header {
            padding: 0.5rem 0;
            position: relative;
            text-align: center;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border-bottom: var(--border-thin);
        }

        .logo-container {
            position: relative;
            margin: 0 auto;
            width: 60px;
            height: 60px;
        }

        .logo-circle {
            position: absolute;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 50%;
        }

        [data-theme="light"] .logo-circle {
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .logo-circle:nth-child(1) {
            width: 60px;
            height: 60px;
            top: 0;
            left: 0;
            animation: rotate 30s linear infinite;
        }

        .logo-circle:nth-child(2) {
            width: 45px;
            height: 45px;
            top: 7.5px;
            left: 7.5px;
            animation: rotate 20s linear infinite reverse;
        }

        .logo-circle:nth-child(3) {
            width: 30px;
            height: 30px;
            top: 15px;
            left: 15px;
            animation: rotate 10s linear infinite;
        }

        @keyframes rotate {
            from {
                transform: rotate(0deg);
            }

            to {
                transform: rotate(360deg);
            }
        }

        h1 {
            font-size: 1.2rem;
            font-weight: 600;
            letter-spacing: 2px;
            margin: 0;
            text-transform: uppercase;
            background: linear-gradient(to right, var(--accent-primary), var(--accent-secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            position: relative;
        }

        h1::after {
            content: "jjugg";
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            color: transparent;
            -webkit-text-stroke: 1px rgba(255, 255, 255, 0.1);
            z-index: -1;
        }

        [data-theme="light"] h1::after {
            -webkit-text-stroke: 1px rgba(0, 0, 0, 0.1);
        }

        nav {
            margin: 0.5rem 0;
            display: flex;
            justify-content: center;
            gap: 0.5rem;
        }

        #login-section {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 0.5rem;
            margin: 0.5rem 0 1rem 0;
            width: 100%;
        }

        #login-section input,
        #login-section button {
            padding: 0.5rem 0.6rem;
            font-size: 0.8rem;
            width: 100%;
        }

        /* App Title */
        .app-title {
            text-align: center;
            font-size: 1.5rem;
            font-weight: 600;
            letter-spacing: 2px;
            margin: 1rem 0;
            text-transform: uppercase;
            color: var(--text-primary);
        }

        /* Theme Toggle */
        .theme-toggle {
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            padding: 8px 10px;
            margin-bottom: 10px;
            border-radius: 6px;
            background: var(--glass-bg);
            border: var(--border-thin);
            color: var(--text-secondary);
            font-family: 'Space Mono', monospace;
            font-size: 0.8rem;
            transition: all 0.3s ease;
            width: 100%;
        }

        .theme-toggle:hover {
            color: var(--text-primary);
            border-color: var(--accent-primary);
        }

        .theme-toggle svg {
            margin-right: 5px;
            width: 16px;
            height: 16px;
        }

        /* Main Content */
        main {
            flex: 1;
            max-width: 1800px;
            width: 95%;
            margin: 0 auto;
            padding: 2rem 0;
        }

        .card {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: var(--border-medium);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            position: relative;
            margin-bottom: 2rem;
        }

        .card-header {
            padding: 1.5rem;
            position: relative;
            overflow: hidden;
            border-bottom: var(--border-thin);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, var(--accent-primary), transparent 80%);
            opacity: 0.1;
            z-index: 0;
        }

        h2 {
            font-size: 1.3rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 2px;
            display: flex;
            align-items: center;
            position: relative;
            z-index: 1;
        }

        h2::before {
            content: "";
            display: inline-block;
            width: 12px;
            height: 12px;
            border: 1px solid var(--accent-primary);
            border-radius: 50%;
            margin-right: 0.8rem;
        }

        .card-content {
            padding: 1.5rem;
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .btn-modal {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-thin);
            padding: 0.5rem 1rem;
            border-radius: 6px;
            color: var(--text-secondary);
            cursor: pointer;
            font-family: 'Space Mono', monospace;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s ease;
        }

        .btn-modal:hover {
            background: var(--accent-primary);
            color: #000;
            border-color: var(--accent-primary);
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .modal.active {
            opacity: 1;
        }

        .modal-content {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: var(--border-medium);
            border-radius: 12px;
            padding: 2rem;
            width: 90%;
            max-width: 600px;
            position: relative;
            max-height: 85vh;
            overflow-y: auto;
            transform: translateY(20px);
            transition: transform 0.3s ease;
            scrollbar-width: thin;
            scrollbar-color: var(--accent-primary) var(--bg-tertiary);
        }

        .modal.active .modal-content {
            transform: translateY(0);
        }

        .modal-content::-webkit-scrollbar {
            width: 8px;
        }

        .modal-content::-webkit-scrollbar-track {
            background: var(--bg-tertiary);
            border-radius: 4px;
        }

        .modal-content::-webkit-scrollbar-thumb {
            background: var(--accent-primary);
            border-radius: 4px;
        }

        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s ease;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .modal-close:hover {
            color: var(--accent-primary);
            background: rgba(255, 255, 255, 0.1);
            transform: rotate(90deg);
        }

        form {
            display: grid;
            gap: 1.2rem;
        }

        .form-group {
            position: relative;
        }

        label {
            font-size: 0.75rem;
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 0.5rem;
            display: block;
            font-family: 'Space Mono', monospace;
        }

        input,
        select,
        textarea {
            width: 100%;
            background: rgba(0, 0, 0, 0.2);
            border: var(--border-thin);
            border-radius: 6px;
            padding: 0.8rem 1rem;
            color: var(--text-primary);
            font-family: 'Inter', sans-serif;
            font-size: 0.95rem;
        }

        [data-theme="light"] input,
        [data-theme="light"] select,
        [data-theme="light"] textarea {
            background: rgba(0, 0, 0, 0.05);
        }

        input:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 1px var(--accent-primary);
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border: none;
            color: #ffffff;
            padding: 0.7rem 1.2rem;
            border-radius: 6px;
            cursor: pointer;
            font-family: 'Space Mono', monospace;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            opacity: 0.9;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 240, 255, 0.3);
        }

        [data-theme="light"] .btn-primary:hover {
            box-shadow: 0 5px 15px rgba(0, 102, 204, 0.3);
        }

        /* Filter and Toggle Controls */
        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .filter-control {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .filter-control select,
        .filter-inputs input,
        .filter-inputs select {
            background: rgba(0, 0, 0, 0.3);
            flex: 1;
        }

        [data-theme="light"] .filter-control select,
        [data-theme="light"] .filter-inputs input,
        [data-theme="light"] .filter-inputs select {
            background: rgba(0, 0, 0, 0.05);
        }

        .filter-inputs {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .filter-inputs input,
        .filter-inputs select {
            padding: 0.5rem;
            font-size: 0.8rem;
        }

        /* Toggle Switch */
        .toggle-container {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .toggle-label {
            font-family: 'Space Mono', monospace;
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--bg-tertiary);
            transition: 0.4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: var(--text-primary);
            transition: 0.4s;
            border-radius: 50%;
        }

        input:checked+.slider {
            background-color: var(--accent-primary);
        }

        input:checked+.slider:before {
            transform: translateX(26px);
        }

        /* Table Styles */
        .table-container {
            overflow-x: auto;
            border-radius: 6px;
            display: block;
        }

        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            font-size: 0.9rem;
        }

        thead {
            position: sticky;
            top: 0;
            z-index: 10;
        }

        th {
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 1px;
            padding: 1rem;
            text-align: left;
            cursor: pointer;
            font-family: 'Space Mono', monospace;
            font-size: 0.8rem;
            position: relative;
        }

        th:hover {
            color: var(--accent-primary);
        }

        th::after {
            content: "↕";
            position: absolute;
            right: 10px;
            opacity: 0.3;
            transition: opacity 0.2s ease;
        }

        th:hover::after {
            opacity: 1;
        }

        td {
            padding: 1rem;
            border-bottom: var(--border-thin);
            color: var(--text-secondary);
        }

        tr:last-child td {
            border-bottom: none;
        }

        tr {
            transition: background 0.2s ease;
        }

        tr:hover {
            background: rgba(255, 255, 255, 0.03);
        }

        [data-theme="light"] tr:hover {
            background: rgba(0, 0, 0, 0.03);
        }

        /* Kanban Board Styles */
        .kanban-container {
            display: none;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
            overflow-x: auto;
            scroll-behavior: smooth;
            padding-bottom: 1rem;
            scrollbar-width: thin;
            scrollbar-color: var(--accent-primary) var(--bg-tertiary);
        }

        .kanban-container::-webkit-scrollbar {
            height: 8px;
        }

        .kanban-container::-webkit-scrollbar-track {
            background: var(--bg-tertiary);
            border-radius: 4px;
        }

        .kanban-container::-webkit-scrollbar-thumb {
            background: var(--accent-primary);
            border-radius: 4px;
        }

        .kanban-column {
            background: var(--glass-bg);
            border: var(--border-medium);
            border-radius: 8px;
            padding: 1rem;
            min-width: 250px;
            display: flex;
            flex-direction: column;
        }

        .kanban-column h3 {
            font-family: 'Space Mono', monospace;
            font-size: 1rem;
            color: var(--text-primary);
            margin-bottom: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .kanban-column h3 .count {
            font-size: 0.75rem;
            background: var(--bg-tertiary);
            border-radius: 12px;
            padding: 0.2rem 0.5rem;
            color: var(--text-secondary);
        }

        .kanban-cards {
            min-height: 50px;
            max-height: 70vh;
            overflow-y: auto;
            padding-right: 0.5rem;
            scrollbar-width: thin;
            scrollbar-color: var(--accent-primary) var(--bg-tertiary);
            flex: 1;
        }

        .kanban-cards::-webkit-scrollbar {
            width: 6px;
        }

        .kanban-cards::-webkit-scrollbar-track {
            background: var(--bg-tertiary);
            border-radius: 4px;
        }

        .kanban-cards::-webkit-scrollbar-thumb {
            background: var(--accent-primary);
            border-radius: 4px;
        }

        .kanban-load-more {
            text-align: center;
            padding: 0.5rem;
            font-size: 0.8rem;
            color: var(--text-secondary);
            background: var(--bg-tertiary);
            border-radius: 4px;
            margin-top: 0.5rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .kanban-load-more:hover {
            color: var(--text-primary);
            background: rgba(255, 255, 255, 0.1);
        }

        .kanban-card {
            background: var(--bg-tertiary);
            border: var(--border-thin);
            border-radius: 6px;
            padding: 1rem;
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
            font-size: 0.9rem;
            transition: all 0.2s ease;
            position: relative;
            overflow: hidden;
        }

        .kanban-card:hover {
            transform: translateY(-2px);
            background: rgba(255, 255, 255, 0.05);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .kanban-card.favorite::before {
            content: "★";
            position: absolute;
            top: -5px;
            right: -5px;
            width: 25px;
            height: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--accent-primary);
            color: #000;
            border-radius: 50%;
            font-size: 0.8rem;
            transform: rotate(15deg);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .kanban-card .title {
            font-weight: 500;
            margin-bottom: 0.5rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .kanban-card .company {
            font-size: 0.8rem;
            color: var(--text-tertiary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .kanban-card .actions {
            margin-top: 0.5rem;
            display: flex;
            gap: 0.5rem;
            opacity: 0.5;
            transition: opacity 0.2s ease;
        }

        .kanban-card:hover .actions {
            opacity: 1;
        }

        /* Status Indicators */
        .status {
            display: inline-flex;
            align-items: center;
            padding: 0.3rem 0.8rem;
            border-radius: 50px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .status::before {
            content: "";
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 0.5rem;
        }

        .status-applied {
            background: rgba(33, 150, 243, 0.1);
            color: var(--status-applied);
        }

        .status-applied::before {
            background: var(--status-applied);
        }

        .status-interview {
            background: rgba(255, 152, 0, 0.1);
            color: var(--status-interview);
        }

        .status-interview::before {
            background: var(--status-interview);
        }

        .status-offer {
            background: rgba(76, 175, 80, 0.1);
            color: var(--status-offer);
        }

        .status-offer::before {
            background: var(--status-offer);
        }

        .status-rejected {
            background: rgba(244, 67, 54, 0.1);
            color: var(--status-rejected);
        }

        .status-rejected::before {
            background: var(--status-rejected);
        }

        /* Action Buttons in Table/Kanban */
        .action-btn {
            padding: 0.4rem 0.7rem;
            font-size: 0.75rem;
            margin-right: 0.3rem;
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s ease;
            border-radius: 4px;
            position: relative;
            overflow: hidden;
        }

        .action-btn::after {
            content: "";
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
            background-image: radial-gradient(circle, var(--accent-primary) 10%, transparent 10.01%);
            background-repeat: no-repeat;
            background-position: 50%;
            transform: scale(10, 10);
            opacity: 0;
            transition: transform 0.5s, opacity 0.5s;
        }

        .action-btn:active::after {
            transform: scale(0, 0);
            opacity: 0.3;
            transition: 0s;
        }

        .action-btn:hover {
            color: var(--accent-primary);
            background: rgba(255, 255, 255, 0.05);
        }

        .action-btn.favorite-btn {
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .action-btn.favorite-btn.active {
            color: gold;
            transform: scale(1.2);
        }

        .action-btn.favorite-btn.active:hover {
            color: gold;
            transform: scale(1.1) rotate(5deg);
        }

        .action-btn.favorite-btn:hover {
            transform: scale(1.1);
        }

        /* Links */
        a {
            color: var(--accent-primary);
            text-decoration: none;
            transition: all 0.2s ease;
            position: relative;
        }

        a::after {
            content: "";
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 0;
            height: 1px;
            background: var(--accent-primary);
            transition: width 0.2s ease;
        }

        a:hover {
            color: var(--accent-secondary);
        }

        a:hover::after {
            width: 100%;
        }

        /* World-Class Analytics Styles */
        .analytics-filter {
            width: auto;
            font-size: 0.8rem;
            padding: 0.3rem 0.5rem;
            background: var(--glass-bg);
            color: var(--text-secondary);
            border: var(--border-thin);
            border-radius: 4px;
        }

        /* KPI Dashboard */
        .kpi-dashboard {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .kpi-card {
            background: var(--glass-bg);
            border: var(--border-thin);
            border-radius: 8px;
            padding: 1rem;
            display: flex;
            align-items: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .kpi-card::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(to right, var(--accent-primary), var(--accent-secondary));
            opacity: 0.6;
        }

        .kpi-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .kpi-icon {
            margin-right: 1rem;
            width: 40px;
            height: 40px;
            border-radius: 8px;
            background: rgba(0, 240, 255, 0.1);
            color: var(--accent-primary);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .kpi-content {
            flex: 1;
        }

        .kpi-label {
            font-size: 0.7rem;
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 1px;
            font-family: 'Space Mono', monospace;
            margin-bottom: 0.3rem;
        }

        .kpi-value {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.3rem;
            line-height: 1;
        }

        .kpi-change {
            font-size: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .kpi-change.positive {
            color: #4CAF50;
        }

        .kpi-change.negative {
            color: #F44336;
        }

        .kpi-change .arrow {
            display: inline-block;
            transition: transform 0.3s ease;
        }

        .kpi-change.positive .arrow {
            transform: rotate(-45deg);
        }

        .kpi-change.negative .arrow {
            transform: rotate(45deg);
        }

        /* Analytics Panel */
        .analytics-panel {
            background: var(--glass-bg);
            border: var(--border-thin);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .analytics-panel h3 {
            font-size: 1rem;
            margin-bottom: 1.2rem;
            color: var(--text-primary);
            position: relative;
            padding-left: 1rem;
            font-weight: 500;
        }

        .analytics-panel h3::before {
            content: "";
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 4px;
            height: 1rem;
            background: var(--accent-primary);
            border-radius: 2px;
        }

        /* Chart Container */
        .chart-container {
            width: 100%;
            margin: 1rem 0;
            position: relative;
        }

        .chart-container.expanded {
            height: 300px;
        }

        .chart-container h3 {
            font-size: 1rem;
            margin-bottom: 0.5rem;
            text-align: center;
            color: var(--text-secondary);
        }

        /* Standard Styling for Charts and Components */
        .cyber-card,
        .card {
            background: var(--glass-bg);
            border: var(--border-medium);
            border-radius: 8px;
            padding: 1.5rem;
            position: relative;
            overflow: hidden;
            margin-bottom: 1.5rem;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .cyber-title,
        .card h4 {
            color: var(--text-primary);
            font-size: 1.1rem;
            font-weight: 500;
            margin-bottom: 1rem;
            position: relative;
            display: inline-block;
        }
        
        .cyber-value,
        .metric-value {
            position: relative;
            display: inline-block;
            font-weight: 600;
        }
        
        /* Sankey Diagram */
        .sankey-container {
            height: 300px;
            position: relative;
            z-index: 5;
        }
        
        .sankey-container .node rect {
            fill-opacity: 0.8;
            shape-rendering: crispEdges;
            stroke: var(--border-thin);
            stroke-width: 1px;
        }
        
        .sankey-container .node text {
            fill: var(--text-primary);
            font-size: 12px;
        }
        
        .sankey-container .link {
            fill: none;
            stroke-opacity: 0.3;
        }
        
        .sankey-container .link:hover {
            stroke-opacity: 0.7;
        }
        
        /* Funnel Chart */
        .funnel-chart {
            height: 300px;
            position: relative;
            z-index: 5;
        }
        
        .funnel-chart .funnel-stage {
            stroke: var(--bg-primary);
            stroke-width: 1px;
            transition: opacity 0.3s ease;
        }
        
        .funnel-chart .funnel-stage:hover {
            opacity: 0.8;
        }
        
        .funnel-chart .funnel-label {
            fill: var(--text-primary);
            font-size: 12px;
            text-anchor: middle;
        }
        
        .funnel-chart .funnel-value {
            fill: var(--text-primary);
            font-size: 12px;
            font-weight: bold;
            text-anchor: middle;
        }
        
        /* Application Funnel */
        .funnel-container {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2rem;
            align-items: start;
            margin-top: 1.5rem;
        }

        .funnel-chart-wrapper {
            width: 100%;
            height: 300px;
        }

        .funnel-metrics {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .funnel-metric {
            background: rgba(0, 0, 0, 0.1);
            padding: 1rem;
            border-radius: 4px;
            transition: all 0.3s ease;
        }
        
        .cyberpunk-metric,
        .funnel-metric {
            background: var(--glass-bg);
            border: var(--border-thin);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
            border-radius: 6px;
        }

        [data-theme="light"] .funnel-metric {
            background: rgba(0, 0, 0, 0.05);
        }

        .funnel-metric:hover {
            background: rgba(0, 240, 255, 0.1);
            transform: translateX(5px);
            box-shadow: 0 0 15px rgba(0, 240, 255, 0.2);
        }

        .metric-label {
            font-size: 0.7rem;
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 1px;
            font-family: 'Space Mono', monospace;
            margin-bottom: 0.5rem;
        }

        .metric-value {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        /* Trends Container */
        .trends-container {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2rem;
        }

        /* Insights */
        .trend-insights, .keywords-insights, .salary-insights, .market-insights {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .insight {
            display: flex;
            gap: 1rem;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        [data-theme="light"] .insight {
            background: rgba(0, 0, 0, 0.05);
        }

        .insight:hover {
            background: rgba(0, 240, 255, 0.1);
            transform: translateX(5px);
        }
        
        /* Insights styling */
        .cyberpunk-insights,
        .trend-insights {
            margin-top: 1rem;
        }
        
        .cyber-insight,
        .insight {
            background: var(--glass-bg);
            border: var(--border-thin);
            border-left: 3px solid var(--accent-primary);
            position: relative;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border-radius: 4px;
        }
        
        .cyber-insight:hover,
        .insight:hover {
            transform: translateX(5px);
            background: rgba(255, 255, 255, 0.05);
        }
        
        .cyber-icon,
        .insight-icon {
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-primary);
            position: relative;
        }
        
        .cyber-insight-title,
        .insight-content h4 {
            font-size: 1rem;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--text-primary);
        }
        
        .cyber-data-point,
        .insight-content span {
            font-weight: 600;
            color: var(--accent-primary);
            position: relative;
        }

        .insight-icon {
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .insight-content h4 {
            font-size: 1rem;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: var(--text-primary);
        }

        .insight-content p {
            font-size: 0.9rem;
            color: var(--text-secondary);
            line-height: 1.5;
        }

        .insight-content span {
            font-weight: 600;
            color: var(--accent-primary);
        }

        /* Salary Intelligence */
        .salary-intelligence {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .salary-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .salary-stat-group {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
        }

        .salary-card {
            padding: 1rem;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            align-items: center;
            transition: all 0.3s ease;
        }

        [data-theme="light"] .salary-card {
            background: rgba(0, 0, 0, 0.05);
        }

        .salary-card:hover {
            background: rgba(0, 240, 255, 0.1);
            transform: translateY(-3px);
        }

        .salary-amount {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-primary);
            margin: 0.5rem 0;
            text-align: center;
        }

        .salary-label {
            font-size: 0.7rem;
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 1px;
            font-family: 'Space Mono', monospace;
            text-align: center;
        }

        .salary-selector {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
        }

        .mini-select {
            font-size: 0.7rem;
            padding: 0.2rem 0.5rem;
            margin-bottom: 0.5rem;
            width: 100%;
            text-align: center;
            background: rgba(0, 0, 0, 0.2);
            border: var(--border-thin);
            border-radius: 4px;
            color: var(--text-secondary);
        }

        [data-theme="light"] .mini-select {
            background: rgba(0, 0, 0, 0.1);
        }

        /* Keywords Analysis */
        .keywords-analysis {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }

        #skills-cloud {
            width: 100%;
            height: 300px;
            position: relative;
        }

        /* Company Insights */
        .company-insights {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }

        .insight-cards {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            height: 100%;
        }

        .insight-card {
            background: rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            padding: 1rem;
            flex: 1;
        }

        [data-theme="light"] .insight-card {
            background: rgba(0, 0, 0, 0.05);
        }

        .insight-card h4 {
            font-size: 1rem;
            margin-bottom: 1rem;
            font-weight: 500;
            color: var(--text-primary);
            text-align: center;
        }

        .insight-card ul {
            list-style: none;
        }

        .insight-card li {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.8rem;
            padding-bottom: 0.8rem;
            border-bottom: var(--border-thin);
            font-size: 0.9rem;
        }

        .insight-card li:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }

        .response-time, .salary-indicator {
            font-weight: 600;
            color: var(--accent-primary);
        }

        /* Market Health */
        .market-health {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 2rem;
        }

        .market-metrics {
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 2rem;
        }

        .market-metric {
            text-align: center;
        }

        .market-value {
            font-size: 2rem;
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .market-label {
            font-size: 0.8rem;
            color: var(--text-tertiary);
            text-transform: uppercase;
            letter-spacing: 1px;
            font-family: 'Space Mono', monospace;
        }

        .market-trend {
            text-align: center;
        }

        .trend-up {
            color: #4CAF50;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .trend-down {
            color: #F44336;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .trend-up svg {
            transform: rotate(-45deg);
        }

        .trend-down svg {
            transform: rotate(45deg);
        }

        .trend-label {
            font-size: 0.7rem;
            color: var(--text-tertiary);
            margin-top: 0.5rem;
        }

        /* Insight Card Container */
        .insight-card-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        
        /* Metric Container */
        .metric-container {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .metric {
            text-align: center;
        }
        
        .metric-value {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.3rem;
        }
        
        /* Remote Insights */
        .remote-insights {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }
        
        .response-rate {
            font-weight: 600;
            color: var(--accent-primary);
        }
        
        /* Chart Mini Container */
        .chart-mini-container {
            height: 150px;
            margin-top: 1rem;
        }
        
        /* Source Analysis */
        .source-analysis {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }

        /* Recommendations */
        .recommendations-panel {
            background: linear-gradient(135deg, rgba(0, 240, 255, 0.1), rgba(157, 0, 255, 0.1));
        }

        .recommendations {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
        }

        .recommendation-card {
            background: var(--glass-bg);
            border: var(--border-thin);
            border-radius: 8px;
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            transition: all 0.3s ease;
        }

        .recommendation-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .recommendation-icon {
            font-size: 2rem;
            margin-bottom: 1rem;
        }

        .recommendation-content h4 {
            font-size: 1rem;
            margin-bottom: 0.8rem;
            font-weight: 500;
            color: var(--text-primary);
        }

        .recommendation-content p {
            font-size: 0.9rem;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        /* Responsive Adjustments */
        @media (max-width: 1200px) {
            .kpi-dashboard, .recommendations {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .funnel-container, .trends-container, .keywords-analysis, .company-insights, 
            .market-health, .remote-insights, .source-analysis, .insight-card-container {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
            
            .salary-stats, .metric-container {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
        }

        @media (max-width: 768px) {
            .kpi-dashboard, .recommendations, .salary-stat-group, .metric-container {
                grid-template-columns: 1fr;
            }
        }

        .mt-4 {
            margin-top: 1rem;
        }

        /* Timeline Styles */
        .timeline {
            position: relative;
            padding: 1rem 0;
        }

        .timeline::before {
            content: "";
            position: absolute;
            top: 0;
            left: 20px;
            height: 100%;
            width: 2px;
            background: linear-gradient(to bottom, var(--accent-primary), var(--accent-secondary));
            opacity: 0.3;
        }

        .timeline-item {
            position: relative;
            padding-left: 45px;
            padding-bottom: 1.5rem;
        }

        .timeline-dot {
            position: absolute;
            left: 14px;
            top: 10px;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: var(--accent-primary);
            border: 3px solid var(--bg-primary);
        }

        [data-theme="light"] .timeline-dot {
            border-color: var(--bg-secondary);
        }

        .timeline-date {
            font-size: 0.7rem;
            color: var(--text-tertiary);
            font-family: 'Space Mono', monospace;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .timeline-content {
            padding: 0.8rem;
            background: var(--glass-bg);
            border-radius: 6px;
            margin-top: 0.5rem;
        }

        [data-theme="light"] .timeline-content {
            background: var(--glass-bg);
        }

        /* Goal Progress */
        .goal-progress {
            width: 100%;
            height: 8px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
            overflow: hidden;
            margin: 0.5rem 0 1rem;
        }

        [data-theme="light"] .goal-progress {
            background: rgba(0, 0, 0, 0.1);
        }

        .goal-bar {
            height: 100%;
            background: linear-gradient(to right, var(--accent-primary), var(--accent-secondary));
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .goal-stats {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        /* Chart Container */
        .chart-container canvas {
            width: 100%;
            height: 250px;
        }

        /* Reminders Styles */
        .reminders-list {
            list-style: none;
        }

        .reminder-item {
            padding: 1rem;
            margin-bottom: 0.8rem;
            background: rgba(255, 152, 0, 0.05);
            border-left: 3px solid var(--status-interview);
            border-radius: 6px;
            font-size: 0.9rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* Export Button */
        .export-container {
            display: flex;
            justify-content: flex-end;
            margin-top: 1.5rem;
        }

        /* Animations */
        .flash {
            animation: flash-animation 0.5s;
        }

        @keyframes flash-animation {
            0% {
                opacity: 0.5;
            }

            100% {
                opacity: 1;
            }
        }

        .fade-in {
            animation: fade-in 0.3s ease forwards;
        }

        @keyframes fade-in {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .slide-in {
            animation: slide-in 0.3s ease forwards;
        }

        @keyframes slide-in {
            from {
                transform: translateX(20px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .pulse {
            animation: pulse 1.5s ease infinite;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.05);
                opacity: 0.8;
            }
            100% {
                transform: scale(1);
                opacity: 1;
            }
        }

        .shake {
            animation: shake 0.5s ease;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-5px); }
            40%, 80% { transform: translateX(5px); }
        }

        .bounce {
            animation: bounce 0.5s ease;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }

        /* Hover Effects */
        .hover-lift {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .hover-lift:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .hover-glow {
            transition: box-shadow 0.2s ease;
        }

        .hover-glow:hover {
            box-shadow: 0 0 10px var(--accent-primary);
        }

        /* Sidebar Navigation Styles */
        .sidebar {
            width: var(--sidebar-width);
            height: 100vh;
            position: fixed;
            left: 0;
            top: 0;
            background: var(--bg-secondary);
            border-right: var(--border-thin);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            overflow-y: auto;
            z-index: 100;
            transition: all 0.3s ease;
        }
        
        .sidebar-nav {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .sidebar-item {
            display: flex;
            align-items: center;
            padding: 1rem 1.5rem;
            cursor: pointer;
            transition: all 0.2s ease;
            color: var(--text-secondary);
            border-left: 3px solid transparent;
        }
        
        .sidebar-item svg {
            margin-right: 1rem;
        }
        
        .sidebar-item:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }
        
        .sidebar-item.active {
            background: var(--bg-tertiary);
            color: var(--accent-primary);
            border-left: 3px solid var(--accent-primary);
        }
        
        .sidebar-footer {
            padding: 1rem;
            border-top: var(--border-thin);
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            margin-top: auto;
        }
        
        .add-application-btn, .save-job-btn {
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }
        
        /* Content Area Styles */
        .content-area {
            margin-left: var(--sidebar-width);
            padding: 1rem;
            min-height: 100vh;
        }
        
        /* Section Content Display */
        .section-content {
            display: none;
        }
        
        .section-content.active {
            display: block;
        }
        
        /* Dashboard Home Styles */
        .quick-actions {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .dashboard-columns {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin: 1.5rem 0;
        }
        
        .dashboard-column {
            background: var(--bg-tertiary);
            border-radius: 8px;
            padding: 1rem;
        }
        
        .dashboard-column h3 {
            margin-bottom: 1rem;
            font-size: 1rem;
            color: var(--text-primary);
        }
        
        .view-all-btn {
            width: 100%;
            padding: 0.5rem;
            margin-top: 1rem;
            background: var(--bg-secondary);
            border: var(--border-thin);
            color: var(--text-secondary);
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .view-all-btn:hover {
            background: var(--accent-primary);
            color: black;
        }
        
        .dashboard-goal-progress {
            background: var(--bg-tertiary);
            border-radius: 8px;
            padding: 1rem;
        }
        
        .dashboard-app-card {
            background: var(--bg-secondary);
            border-radius: 6px;
            padding: 0.8rem;
            margin-bottom: 0.8rem;
            transition: all 0.2s ease;
        }
        
        .dashboard-app-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        
        .dashboard-app-title {
            font-weight: 500;
            color: var(--text-primary);
        }
        
        .dashboard-app-company {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 0.3rem;
        }
        
        .dashboard-app-date, .dashboard-app-status {
            font-size: 0.8rem;
            display: inline-block;
            margin-right: 1rem;
        }
        
        .dashboard-app-date {
            color: var(--text-tertiary);
        }
        
        .dashboard-app-status {
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            background: rgba(33, 150, 243, 0.1);
            color: var(--status-applied);
        }
        
        .status-applied {
            background: rgba(33, 150, 243, 0.1);
            color: var(--status-applied);
        }
        
        .status-interview-scheduled {
            background: rgba(255, 152, 0, 0.1);
            color: var(--status-interview);
        }
        
        .status-offer-received {
            background: rgba(76, 175, 80, 0.1);
            color: var(--status-offer);
        }
        
        .status-rejected {
            background: rgba(244, 67, 54, 0.1);
            color: var(--status-rejected);
        }
        
        .dashboard-reminder {
            background: var(--bg-secondary);
            border-radius: 6px;
            padding: 0.8rem;
            margin-bottom: 0.8rem;
            display: flex;
            flex-direction: column;
            gap: 0.3rem;
        }
        
        .dashboard-reminder-title {
            font-weight: 500;
            color: var(--text-primary);
        }
        
        .dashboard-reminder-days {
            font-size: 0.8rem;
            color: var(--text-tertiary);
        }
        
        .reminder-action-btn {
            align-self: flex-start;
            padding: 0.3rem 0.6rem;
            font-size: 0.8rem;
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .reminder-action-btn:hover {
            background: var(--accent-primary);
            color: black;
        }
        
        /* Analytics Tabs Styles */
        .analytics-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            border-bottom: var(--border-thin);
            padding-bottom: 0.5rem;
        }
        
        .analytics-tab {
            padding: 0.5rem 1rem;
            background: var(--bg-tertiary);
            border: none;
            border-radius: 4px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .analytics-tab:hover {
            background: rgba(0, 240, 255, 0.1);
            color: var(--text-primary);
        }
        
        .analytics-tab.active {
            background: var(--accent-primary);
            color: black;
        }
        
        .analytics-tab-content {
            display: none;
        }
        
        .analytics-tab-content.active {
            display: block;
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .filter-inputs {
                grid-template-columns: repeat(4, 1fr);
            }

            .kanban-container {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .dashboard-columns {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 992px) {
            .sidebar {
                width: 60px;
            }
            
            .sidebar-item span {
                display: none;
            }
            
            .sidebar-item svg {
                margin-right: 0;
            }
            
            .sidebar-footer {
                display: none;
            }
            
            .content-area {
                margin-left: 60px;
            }
        }

        @media (max-width: 768px) {
            .logo-container {
                width: 50px;
                height: 50px;
            }

            .logo-circle:nth-child(1) {
                width: 50px;
                height: 50px;
            }

            .logo-circle:nth-child(2) {
                width: 37.5px;
                height: 37.5px;
                top: 6.25px;
                left: 6.25px;
            }

            .logo-circle:nth-child(3) {
                width: 25px;
                height: 25px;
                top: 12.5px;
                left: 12.5px;
            }

            h1 {
                font-size: 1rem;
            }

            .analytics {
                flex-direction: column;
                align-items: center;
            }

            .salary-container {
                grid-template-columns: 1fr;
            }

            .filter-inputs {
                grid-template-columns: 1fr 1fr;
            }

            .kanban-container {
                grid-template-columns: 1fr;
            }

            nav {
                flex-direction: row;
                gap: 0.3rem;
            }

            #login-section {
                flex-direction: column;
                gap: 0.3rem;
            }
        }

        @media (max-width: 576px) {
            .sidebar {
                width: 100%;
                height: 60px;
                bottom: 0;
                top: auto;
                border-top: var(--border-thin);
                border-right: none;
                flex-direction: row;
            }
            
            .sidebar-nav {
                display: flex;
                width: 100%;
                justify-content: space-around;
            }
            
            .sidebar-item {
                flex-direction: column;
                padding: 0.5rem;
                border-left: none;
                border-top: 3px solid transparent;
                font-size: 0.7rem;
            }
            
            .sidebar-item.active {
                border-left: none;
                border-top: 3px solid var(--accent-primary);
            }
            
            .sidebar-item svg {
                margin-right: 0;
                margin-bottom: 0.3rem;
                width: 16px;
                height: 16px;
            }
            
            .sidebar-item span {
                display: block;
                font-size: 0.7rem;
            }
            
            .content-area {
                margin-left: 0;
                margin-bottom: 60px;
                padding: 0.5rem;
            }
        }

        @media (max-width: 480px) {
            main {
                width: 100%;
                padding: 0.5rem;
            }

            .chart-container {
                max-width: 100%;
            }

            h1 {
                font-size: 0.9rem;
            }

            .card-content {
                padding: 1rem;
            }

            .filter-inputs {
                grid-template-columns: 1fr;
            }

            .theme-toggle {
                top: 5px;
                right: 5px;
                padding: 3px 8px;
                font-size: 0.7rem;
            }

            .theme-toggle svg {
                width: 14px;
                height: 14px;
            }
        }
    </style>
</head>

<body>
    <!-- Simple application title -->
    <h1 class="app-title">jjugg</h1>

    <!-- Main Content with Sidebar Navigation -->
    <main>
        <!-- Sidebar Navigation -->
        <div class="sidebar">
            <ul class="sidebar-nav">
                <li class="sidebar-item active" data-target="dashboard-home">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
                    <span>Home</span>
                </li>
                <li class="sidebar-item" data-target="applications-section">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect></svg>
                    <span>Applications</span>
                </li>
                <li class="sidebar-item" data-target="reminders-section">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path><path d="M13.73 21a2 2 0 0 1-3.46 0"></path></svg>
                    <span>Reminders</span>
                </li>
                <li class="sidebar-item" data-target="analytics-section">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="20" x2="18" y2="10"></line><line x1="12" y1="20" x2="12" y2="4"></line><line x1="6" y1="20" x2="6" y2="14"></line></svg>
                    <span>Analytics</span>
                </li>
                <li class="sidebar-item" data-target="goals-section">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
                    <span>Goals</span>
                </li>
                <li class="sidebar-item" data-target="timeline-section">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="19" x2="12" y2="5"></line><polyline points="5 12 12 5 19 12"></polyline></svg>
                    <span>Timeline</span>
                </li>
            </ul>
            <div class="sidebar-footer">
                <!-- Theme Toggle -->
                <div class="theme-toggle" onclick="toggleTheme()">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" id="theme-icon">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                    <span id="theme-text">Light Mode</span>
                </div>
                
                <!-- Login Section -->
                <div id="login-section">
                    <input type="text" id="github-token-input" placeholder="Enter your GitHub PAT" />
                    <button class="btn-modal" onclick="handleLogin()">Login with GitHub</button>
                    <button class="btn-modal" onclick="logout()" id="logout-btn" style="display: none;">Logout</button>
                </div>
                
                <button class="btn-primary add-application-btn" onclick="openModal('app-modal')">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                    Add Application
                </button>
                <button class="btn-modal save-job-btn" onclick="openModal('save-job-modal')">Save Job</button>
            </div>
        </div>
        
        <!-- Content Area -->
        <div class="content-area">
            <!-- Dashboard -->
            <div id="dashboard">
                <!-- Dashboard Home Section -->
                <section class="card section-content" id="dashboard-home">
                    <div class="card-header">
                        <h2>Dashboard</h2>
                    </div>
                    <div class="card-content">
                        <!-- Quick Actions -->
                        <div class="quick-actions">
                            <button class="btn-primary" onclick="openModal('app-modal')">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                                Add Application
                            </button>
                            <button class="btn-modal" onclick="openModal('save-job-modal')">Save Job</button>
                        </div>
                        
                        <!-- KPI Dashboard (Key metrics only) -->
                        <div class="kpi-dashboard">
                            <div class="kpi-card" id="kpi-application-count">
                                <div class="kpi-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"></path><rect x="8" y="2" width="8" height="4" rx="1" ry="1"></rect></svg>
                                </div>
                                <div class="kpi-content">
                                    <div class="kpi-label">Total Applications</div>
                                    <div class="kpi-value" id="total-applications">0</div>
                                    <div class="kpi-change" id="application-rate">0/week <span class="arrow">→</span></div>
                                </div>
                            </div>
                            <div class="kpi-card" id="kpi-response-rate">
                                <div class="kpi-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path></svg>
                                </div>
                                <div class="kpi-content">
                                    <div class="kpi-label">Response Rate</div>
                                    <div class="kpi-value" id="response-rate-value">0%</div>
                                    <div class="kpi-change" id="response-rate-change">0% <span class="arrow">→</span></div>
                                </div>
                            </div>
                            <div class="kpi-card" id="kpi-interview-rate">
                                <div class="kpi-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>
                                </div>
                                <div class="kpi-content">
                                    <div class="kpi-label">Interview Rate</div>
                                    <div class="kpi-value" id="interview-rate-value">0%</div>
                                    <div class="kpi-change" id="interview-rate-change">0% <span class="arrow">→</span></div>
                                </div>
                            </div>
                            <div class="kpi-card" id="kpi-active-applications">
                                <div class="kpi-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
                                </div>
                                <div class="kpi-content">
                                    <div class="kpi-label">Active Applications</div>
                                    <div class="kpi-value" id="active-applications">0</div>
                                    <div class="kpi-change" id="active-applications-change">0 pending <span class="arrow">→</span></div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Recent Applications & Reminders -->
                        <div class="dashboard-columns">
                            <div class="dashboard-column">
                                <h3>Recent Applications</h3>
                                <div id="recent-applications">
                                    <!-- Recent applications will be populated here by JavaScript -->
                                </div>
                                <button class="view-all-btn" onclick="switchToSection('applications-section')">View All</button>
                            </div>
                            <div class="dashboard-column">
                                <h3>Follow-up Reminders</h3>
                                <div id="dashboard-reminders">
                                    <!-- Reminders will be populated here by JavaScript -->
                                </div>
                                <button class="view-all-btn" onclick="switchToSection('reminders-section')">View All</button>
                            </div>
                        </div>
                        
                        <!-- Weekly Goal Progress -->
                        <div class="dashboard-goal-progress">
                            <h3>Weekly Application Target</h3>
                            <div class="goal-progress">
                                <div class="goal-bar" id="dashboard-weekly-goal-progress"></div>
                            </div>
                            <div class="goal-stats">
                                <span id="dashboard-weekly-apps-submitted">0 applications</span>
                                <span id="dashboard-weekly-goal-target">Goal: 10/week</span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Applications Section -->
                <section class="card section-content" id="applications-section" style="display: none;">
                    <div class="card-header">
                        <h2>Applications</h2>
                        <div class="toggle-container">
                            <label class="toggle-label" for="view-toggle">Kanban View</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="view-toggle" onchange="toggleView()">
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                    <div class="card-content">
                        <div class="controls">
                            <div class="filter-control">
                                <select id="filter" title="Filter applications by status or favorites">
                                    <option value="All">All Applications</option>
                                    <option value="Applied">Applied</option>
                                    <option value="Interview Scheduled">Interview Scheduled</option>
                                    <option value="Offer Received">Offer Received</option>
                                    <option value="Rejected">Rejected</option>
                                    <option value="Favorites">Favorites</option>
                                </select>
                            </div>
                        </div>
                        <div class="filter-inputs">
                            <input type="text" id="filter-title" placeholder="Filter Title" title="Filter by job title">
                            <input type="text" id="filter-company" placeholder="Filter Company"
                                title="Filter by company name">
                            <input type="date" id="filter-date" title="Filter by application date">
                            <select id="filter-status" title="Filter by status">
                                <option value="">All Statuses</option>
                                <option value="Applied">Applied</option>
                                <option value="Interview Scheduled">Interview Scheduled</option>
                                <option value="Offer Received">Offer Received</option>
                                <option value="Rejected">Rejected</option>
                            </select>
                            <input type="number" id="filter-expected" placeholder="Min Expected $"
                                title="Filter by minimum expected salary">
                            <input type="number" id="filter-offered" placeholder="Min Offered $"
                                title="Filter by minimum offered salary">
                            <input type="text" id="filter-notes" placeholder="Filter Notes" title="Filter by notes">
                            <input type="text" id="filter-url" placeholder="Filter URL" title="Filter by URL">
                        </div>
                        <div class="table-container" id="table-view">
                            <table id="applications-table">
                                <thead>
                                    <tr>
                                        <th onclick="sortTable(0)">Job Title</th>
                                        <th onclick="sortTable(1)">Company</th>
                                        <th onclick="sortTable(2)">Date</th>
                                        <th onclick="sortTable(3)">Status</th>
                                        <th onclick="sortTable(4)">Expected Salary</th>
                                        <th onclick="sortTable(5)">Offered Salary</th>
                                        <th onclick="sortTable(6)">Notes</th>
                                        <th onclick="sortTable(7)">URL</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                        <div class="kanban-container" id="kanban-view">
                            <div class="kanban-column" data-status="Applied">
                                <h3>Applied</h3>
                                <div class="kanban-cards" id="kanban-applied"></div>
                            </div>
                            <div class="kanban-column" data-status="Interview Scheduled">
                                <h3>Interview Scheduled</h3>
                                <div class="kanban-cards" id="kanban-interview"></div>
                            </div>
                            <div class="kanban-column" data-status="Offer Received">
                                <h3>Offer Received</h3>
                                <div class="kanban-cards" id="kanban-offer"></div>
                            </div>
                            <div class="kanban-column" data-status="Rejected">
                                <h3>Rejected</h3>
                                <div class="kanban-cards" id="kanban-rejected"></div>
                            </div>
                        </div>
                        <div class="export-container">
                            <button onclick="exportData()" title="Export application data to CSV">Export Data</button>
                        </div>
                    </div>
                </section>

                <!-- Reminders Section -->
                <section class="card section-content" id="reminders-section" style="display: none;">
                    <div class="card-header">
                        <h2>Follow-up Reminders</h2>
                    </div>
                    <div class="card-content">
                        <ul class="reminders-list" id="reminders-list"></ul>
                    </div>
                </section>

                <!-- Analytics Section -->
                <section class="card section-content" id="analytics-section" style="display: none;">
                    <div class="card-header">
                        <h2>Job Search Analytics</h2>
                        <select id="analytics-time-range" class="analytics-filter" title="Filter analytics by time range">
                            <option value="all">All Time</option>
                            <option value="year">Past Year</option>
                            <option value="quarter">Past Quarter</option>
                            <option value="month" selected>Past Month</option>
                            <option value="week">Past Week</option>
                        </select>
                    </div>
                    <div class="card-content">
                        <!-- Analytics Tabs -->
                        <div class="analytics-tabs">
                            <button class="analytics-tab active" data-tab="pipeline">Application Pipeline</button>
                            <button class="analytics-tab" data-tab="activity">Activity & Trends</button>
                            <button class="analytics-tab" data-tab="remote">Remote Jobs</button>
                            <button class="analytics-tab" data-tab="salary">Salary Insights</button>
                            <button class="analytics-tab" data-tab="sources">Source Analysis</button>
                        </div>
                        
                        <!-- Application Pipeline Tab -->
                        <div class="analytics-tab-content active" id="pipeline-tab">
                            <div class="card">
                                <h4>Application Journey</h4>
                                <div id="sankey-diagram" class="sankey-container"></div>
                            </div>
                            
                            <div class="funnel-container">
                                <div class="card">
                                    <h4>Conversion Funnel</h4>
                                    <div id="funnel-chart-container" class="funnel-chart"></div>
                                </div>
                                <div class="funnel-metrics">
                                    <div class="funnel-metric">
                                        <div class="metric-label">Time to First Response</div>
                                        <div class="metric-value" id="time-to-response">0 days</div>
                                    </div>
                                    <div class="funnel-metric">
                                        <div class="metric-label">Time to Interview</div>
                                        <div class="metric-value" id="time-to-interview">0 days</div>
                                    </div>
                                    <div class="funnel-metric">
                                        <div class="metric-label">Time to Offer</div>
                                        <div class="metric-value" id="time-to-offer">0 days</div>
                                    </div>
                                    <div class="funnel-metric">
                                        <div class="metric-label">Average Cycle</div>
                                        <div class="metric-value" id="avg-cycle-time">0 days</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Activity & Trends Tab -->
                        <div class="analytics-tab-content" id="activity-tab">
                            <div class="card">
                                <h4>Application Activity Timeline</h4>
                                <div class="chart-container expanded">
                                    <canvas id="application-trends-chart"></canvas>
                                </div>
                            </div>
                            <div class="trends-container">
                                <div class="card" style="flex: 2;">
                                    <h4>Key Insights</h4>
                                    <div class="trend-insights" id="trend-insights">
                                        <div class="insight">
                                            <div class="insight-icon">📆</div>
                                            <div class="insight-content">
                                                <h4>Optimal Application Day</h4>
                                                <p>Your most successful applications were submitted on <span id="peak-day">Wednesday</span>.</p>
                                            </div>
                                        </div>
                                        <div class="insight">
                                            <div class="insight-icon">🔍</div>
                                            <div class="insight-content">
                                                <h4>Job Board Performance</h4>
                                                <p><span id="best-job-board">LinkedIn</span> has provided the best response rate at <span id="best-job-board-rate">35%</span>.</p>
                                            </div>
                                        </div>
                                        <div class="insight">
                                            <div class="insight-icon">🎯</div>
                                            <div class="insight-content">
                                                <h4>Weekly Application Goal</h4>
                                                <p>Target: <span id="weekly-app-goal">10</span> applications/week. Current: <span id="current-weekly-rate">7</span>/week.</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Remote Jobs Tab -->
                        <div class="analytics-tab-content" id="remote-tab">
                            <div class="remote-insights">
                                <div class="chart-container">
                                    <canvas id="remote-vs-onsite-chart"></canvas>
                                </div>
                                <div class="insight-card-container">
                                    <div class="insight-card">
                                        <h4>Remote Job Success</h4>
                                        <div class="metric-container">
                                            <div class="metric">
                                                <div class="metric-value" id="remote-application-count">0</div>
                                                <div class="metric-label">Applications</div>
                                            </div>
                                            <div class="metric">
                                                <div class="metric-value" id="remote-response-rate">0%</div>
                                                <div class="metric-label">Response Rate</div>
                                            </div>
                                            <div class="metric">
                                                <div class="metric-value" id="remote-interview-rate">0%</div>
                                                <div class="metric-label">Interview Rate</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="insight-card">
                                        <h4>Top Remote Platforms</h4>
                                        <ul id="top-remote-platforms">
                                            <li>We Work Remotely <span class="response-rate">35%</span></li>
                                            <li>Remote OK <span class="response-rate">28%</span></li>
                                            <li>LinkedIn Remote <span class="response-rate">22%</span></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Salary Insights Tab -->
                        <div class="analytics-tab-content" id="salary-tab">
                            <div class="salary-intelligence">
                                <div class="salary-stats">
                                    <div class="salary-stat-group">
                                        <div class="salary-card">
                                            <div class="salary-label">Average Expected</div>
                                            <div class="salary-amount" id="avg-expected">$0</div>
                                        </div>
                                        <div class="salary-card">
                                            <div class="salary-label">Average Offered</div>
                                            <div class="salary-amount" id="avg-offered">$0</div>
                                        </div>
                                        <div class="salary-card">
                                            <div class="salary-label">Offer vs. Expected</div>
                                            <div class="salary-amount" id="offer-expected-ratio">0%</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="chart-container expanded">
                                    <canvas id="salary-comparison-chart"></canvas>
                                </div>
                                <div class="salary-insights">
                                    <div class="insight">
                                        <div class="insight-icon">💰</div>
                                        <div class="insight-content">
                                            <h4>Remote vs. On-site</h4>
                                            <p>Remote positions offer <span id="remote-salary-diff">3%</span> <span id="remote-salary-direction">lower</span> salaries than on-site roles in your data.</p>
                                        </div>
                                    </div>
                                    <div class="insight">
                                        <div class="insight-icon">📊</div>
                                        <div class="insight-content">
                                            <h4>Salary by Job Title</h4>
                                            <p><span id="highest-paying-title">Senior Developer</span> roles show the highest average salary at <span id="highest-title-salary">$120K</span>.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Source Analysis Tab -->
                        <div class="analytics-tab-content" id="sources-tab">
                            <div class="source-analysis">
                                <div class="chart-container">
                                    <canvas id="source-comparison-chart"></canvas>
                                </div>
                                <div class="insight-cards">
                                    <div class="insight-card">
                                        <h4>Manual vs. Automatic</h4>
                                        <p>
                                            <span id="auto-track-count">0</span> applications tracked automatically (<span id="auto-track-percent">0%</span>)<br>
                                            <span id="manual-track-count">0</span> applications added manually (<span id="manual-track-percent">0%</span>)
                                        </p>
                                        <div class="chart-mini-container">
                                            <canvas id="tracking-method-chart"></canvas>
                                        </div>
                                    </div>
                                    <div class="insight-card">
                                        <h4>Top Performing Sources</h4>
                                        <ul id="top-sources">
                                            <li>LinkedIn <span class="response-time">45% response</span></li>
                                            <li>We Work Remotely <span class="response-time">38% response</span></li>
                                            <li>Direct Company <span class="response-time">32% response</span></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Actionable Recommendations -->
                            <div class="recommendations-panel">
                                <h3>Actionable Recommendations</h3>
                                <div class="recommendations">
                                    <div class="recommendation-card">
                                        <div class="recommendation-icon">🚀</div>
                                        <div class="recommendation-content">
                                            <h4>Application Strategy</h4>
                                            <p>Increase focus on <span id="rec-job-board">We Work Remotely</span> - it has your highest response rate at <span id="rec-response-rate">38%</span>.</p>
                                        </div>
                                    </div>
                                    <div class="recommendation-card">
                                        <div class="recommendation-icon">🔄</div>
                                        <div class="recommendation-content">
                                            <h4>Follow-up Reminder</h4>
                                            <p><span id="followup-count">3</span> applications need follow-up (applied >10 days ago). See Reminders section.</p>
                                        </div>
                                    </div>
                                    <div class="recommendation-card">
                                        <div class="recommendation-icon">📈</div>
                                        <div class="recommendation-content">
                                            <h4>Weekly Goal</h4>
                                            <p>You're <span id="goal-status">below</span> your weekly goal. Try to submit <span id="remaining-apps">3</span> more applications this week.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Goals Section -->
                <section class="card section-content" id="goals-section" style="display: none;">
                    <div class="card-header">
                        <h2>Job Search Goals</h2>
                    </div>
                    <div class="card-content">
                        <div class="goal-container">
                            <h3>Weekly Application Target</h3>
                            <div class="goal-progress">
                                <div class="goal-bar" id="weekly-goal-progress"></div>
                            </div>
                            <div class="goal-stats">
                                <span id="weekly-apps-submitted">0 applications</span>
                                <span id="weekly-goal-target">Goal: 10/week</span>
                            </div>
                            <h3 class="mt-4">Application Activity</h3>
                            <div class="chart-container">
                                <canvas id="application-chart"></canvas>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Timeline Section -->
                <section class="card section-content" id="timeline-section" style="display: none;">
                    <div class="card-header">
                        <h2>Application Timeline</h2>
                    </div>
                    <div class="card-content">
                        <div class="timeline" id="app-timeline"></div>
                    </div>
                </section>
            </div>

            <!-- Profile Page -->
            <div id="profile-page" style="display: none;">
                <section class="card">
                    <div class="card-header">
                        <h2>GitHub Profile</h2>
                    </div>
                    <div class="card-content" id="profile-info"></div>
                </section>
                <section class="card">
                    <div class="card-header">
                        <h2>Projects</h2>
                        <div class="toggle-container">
                            <label class="toggle-label" for="projects-view-toggle">Kanban View</label>
                            <label class="toggle-switch">
                                <input type="checkbox" id="projects-view-toggle" onchange="toggleProjectsView()">
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                    <div class="card-content">
                        <div class="table-container" id="projects-table-view">
                            <div class="filter-inputs">
                                <input type="text" id="filter-project-name" placeholder="Filter Name">
                                <input type="text" id="filter-project-description" placeholder="Filter Description">
                                <input type="text" id="filter-project-language" placeholder="Filter Language">
                                <input type="number" id="filter-project-stars" placeholder="Min Stars">
                                <input type="number" id="filter-project-forks" placeholder="Min Forks">
                                <input type="date" id="filter-project-updated" placeholder="Updated After">
                            </div>
                            <table id="projects-table">
                                <thead>
                                    <tr>
                                        <th onclick="sortProjectsTable(0)">Name</th>
                                        <th onclick="sortProjectsTable(1)">Description</th>
                                        <th onclick="sortProjectsTable(2)">Language</th>
                                        <th onclick="sortProjectsTable(3)">Stars</th>
                                        <th onclick="sortProjectsTable(4)">Forks</th>
                                        <th onclick="sortProjectsTable(5)">Last Updated</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                        <div class="kanban-container" id="projects-kanban-view" style="display: none;"></div>
                    </div>
                </section>
                <section class="card">
                    <div class="card-header">
                        <h2>Analytics</h2>
                    </div>
                    <div class="card-content" id="profile-analytics"></div>
                </section>
            </div>
        </div>
    </main>

    <!-- Add Application Modal -->
    <div class="modal" id="app-modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('app-modal')">×</button>
            <h2>Add Application</h2>
            <form id="app-form">
                <div class="form-group">
                    <label for="title">Job Title</label>
                    <input type="text" id="title" required>
                </div>
                <div class="form-group">
                    <label for="company">Company</label>
                    <input type="text" id="company" required>
                </div>
                <div class="form-group">
                    <label for="date">Date</label>
                    <input type="date" id="date" required>
                </div>
                <div class="form-group">
                    <label for="status">Status</label>
                    <select id="status">
                        <option value="Applied">Applied</option>
                        <option value="Interview Scheduled">Interview Scheduled</option>
                        <option value="Offer Received">Offer Received</option>
                        <option value="Rejected">Rejected</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="expected-salary">Expected Salary</label>
                    <input type="number" id="expected-salary" placeholder="$">
                </div>
                <div class="form-group">
                    <label for="offered-salary">Offered Salary</label>
                    <input type="number" id="offered-salary" placeholder="$">
                </div>
                <div class="form-group">
                    <label for="notes">Notes</label>
                    <textarea id="notes"></textarea>
                </div>
                <div class="form-group">
                    <label for="url">URL</label>
                    <input type="url" id="url">
                </div>
                <button type="submit" class="btn-primary">Add Application</button>
            </form>
        </div>
    </div>

    <!-- Save Job Modal -->
    <div class="modal" id="save-job-modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('save-job-modal')">×</button>
            <h2>Save Job</h2>
            <form id="save-job-form">
                <div class="form-group">
                    <label for="save-title">Job Title</label>
                    <input type="text" id="save-title" required>
                </div>
                <div class="form-group">
                    <label for="save-company">Company</label>
                    <input type="text" id="save-company" required>
                </div>
                <div class="form-group">
                    <label for="save-url">URL</label>
                    <input type="url" id="save-url">
                </div>
                <div class="form-group">
                    <label for="save-notes">Notes</label>
                    <textarea id="save-notes"></textarea>
                </div>
                <button type="submit" class="btn-primary">Save Job</button>
            </form>
        </div>
    </div>

    <!-- Application Details Modal -->
    <div class="modal" id="details-modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('details-modal')">×</button>
            <h2>Application Details</h2>
            <div id="details-content">
                <p><strong>Title:</strong> <span id="detail-title"></span></p>
                <p><strong>Company:</strong> <span id="detail-company"></span></p>
                <p><strong>Date:</strong> <span id="detail-date"></span></p>
                <p><strong>Status:</strong> <span id="detail-status"></span></p>
                <p><strong>Expected Salary:</strong> <span id="detail-expected"></span></p>
                <p><strong>Offered Salary:</strong> <span id="detail-offered"></span></p>
                <p><strong>Notes:</strong> <span id="detail-notes"></span></p>
                <p><strong>URL:</strong> <span id="detail-url-container"></span></p>
                <h3>History</h3>
                <div class="timeline" id="detail-timeline"></div>
            </div>
        </div>
    </div>

    <!-- Project Details Modal -->
    <div class="modal" id="project-details-modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('project-details-modal')">×</button>
            <h2>Project Details</h2>
            <div id="project-details-content"></div>
        </div>
    </div>

    <!-- Project Analytics Modal -->
    <div class="modal" id="project-analytics-modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('project-analytics-modal')">×</button>
            <h2>Project Analytics</h2>
            <div id="project-analytics-content"></div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // Initial Data with Favorite Property
        const fakeData = [
            { id: 1, title: "Software Engineer", company: "TechCorp", date: "2025-02-20", status: "Applied", notes: "Submitted via company site", url: "https://techcorp.com/jobs", history: [{ date: "2025-02-20", status: "Applied", notes: "Submitted application" }], salary: { expected: 120000, offered: null, benefits: "Healthcare, 401k" }, favorite: false },
            { id: 2, title: "Data Analyst", company: "DataWorks", date: "2025-02-15", status: "Interview Scheduled", notes: "Phone screen next week", url: "https://dataworks.com/careers", history: [{ date: "2025-02-15", status: "Applied", notes: "Submitted application" }, { date: "2025-02-18", status: "Interview Scheduled", notes: "Got email for phone screen" }], salary: { expected: 95000, offered: null, benefits: "" }, favorite: false },
            { id: 3, title: "Product Manager", company: "Innovate Inc", date: "2025-01-25", status: "Applied", notes: "Awaiting response", url: "https://innovateinc.com/apply", history: [{ date: "2025-01-25", status: "Applied", notes: "Applied through referral" }], salary: { expected: 140000, offered: null, benefits: "" }, favorite: false },
            { id: 4, title: "UX Designer", company: "Designify", date: "2025-03-01", status: "Offer Received", notes: "Negotiating salary", url: "https://designify.com/jobs", history: [{ date: "2025-03-01", status: "Applied", notes: "Applied online" }, { date: "2025-03-05", status: "Interview Scheduled", notes: "Portfolio review" }, { date: "2025-03-10", status: "Interview Scheduled", notes: "Team interview" }, { date: "2025-03-15", status: "Offer Received", notes: "Initial offer made" }], salary: { expected: 110000, offered: 105000, benefits: "Healthcare, 401k, Remote work" }, favorite: false },
            { id: 5, title: "DevOps Engineer", company: "CloudNet", date: "2025-02-10", status: "Rejected", notes: "Not enough experience", url: "https://cloudnet.com/careers", history: [{ date: "2025-02-10", status: "Applied", notes: "Applied online" }, { date: "2025-02-15", status: "Interview Scheduled", notes: "Technical screen" }, { date: "2025-02-20", status: "Rejected", notes: "Got rejection email" }], salary: { expected: 130000, offered: null, benefits: "" }, favorite: false }
        ];

        let applications = fakeData;
        let savedJobs = [];
        let isKanbanView = false;
        let githubData = null;
        let isProjectsKanbanView = false;

        const kanbanCategories = {
            'Recently Updated': repo => new Date(repo.updated_at) > new Date(Date.now() - 30 * 24 * 60 * 60 * 1000),
            'Older Projects': repo => new Date(repo.updated_at) <= new Date(Date.now() - 30 * 24 * 60 * 60 * 1000)
        };

        // Load Data on Page Load
        document.addEventListener('DOMContentLoaded', () => {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                document.documentElement.setAttribute('data-theme', savedTheme);
                document.getElementById('theme-text').textContent = savedTheme === 'dark' ? 'Light Mode' : 'Dark Mode';
            }

            const storedApps = localStorage.getItem('jobApplications');
            if (storedApps) {
                try {
                    applications = JSON.parse(storedApps).map(app => ({ ...app, favorite: app.favorite || false }));
                } catch (e) {
                    console.error('Error parsing stored applications:', e);
                    applications = fakeData;
                }
            }

            const storedSavedJobs = localStorage.getItem('savedJobs');
            if (storedSavedJobs) {
                try {
                    savedJobs = JSON.parse(storedSavedJobs);
                } catch (e) {
                    console.error('Error parsing stored saved jobs:', e);
                    savedJobs = [];
                }
            }

            // Initialize sidebar navigation
            initSidebar();
            
            // Setup content sections
            document.getElementById('dashboard-home').style.display = 'block';
            
            // Render all sections
            renderTable();
            renderAnalytics();
            renderReminders();
            renderDashboard();
            renderTimeline();
            updateGoalProgress();
            document.getElementById('date').value = new Date().toISOString().split('T')[0];

            // Real-time Filtering for Applications
            document.querySelectorAll('.filter-inputs input, .filter-inputs select, #filter').forEach(input => {
                input.addEventListener('input', () => {
                    if (isKanbanView) renderKanban();
                    else renderTable();
                });
            });

            // Setup analytics tabs
            document.querySelectorAll('.analytics-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    // Remove active class from all tabs
                    document.querySelectorAll('.analytics-tab').forEach(t => {
                        t.classList.remove('active');
                    });
                    
                    // Add active class to clicked tab
                    tab.classList.add('active');
                    
                    // Hide all tab content
                    document.querySelectorAll('.analytics-tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    
                    // Show content for active tab
                    const tabId = tab.dataset.tab;
                    document.getElementById(`${tabId}-tab`).classList.add('active');
                });
            });

            // Check for existing GitHub token
            const token = localStorage.getItem('githubToken');
            if (token) {
                document.getElementById('login-section').children[0].style.display = 'none';
                document.getElementById('login-section').children[1].style.display = 'none';
                document.getElementById('logout-btn').style.display = 'inline-block';
                fetchGitHubData(token);
            }
        });
        
        // Initialize Sidebar Navigation
        function initSidebar() {
            document.querySelectorAll('.sidebar-item').forEach(item => {
                item.addEventListener('click', () => {
                    if (item.dataset.target) {
                        switchToSection(item.dataset.target);
                    }
                });
            });
        }
        
        // Switch between sections
        function switchToSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.section-content').forEach(section => {
                section.style.display = 'none';
            });
            
            // Remove active class from all sidebar items
            document.querySelectorAll('.sidebar-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionId).style.display = 'block';
            
            // Highlight active sidebar item
            document.querySelector(`.sidebar-item[data-target="${sectionId}"]`).classList.add('active');
        }
        
        // Render Dashboard Home
        function renderDashboard() {
            // Render Recent Applications
            const recentAppsContainer = document.getElementById('recent-applications');
            recentAppsContainer.innerHTML = '';
            
            const recentApps = [...applications]
                .sort((a, b) => new Date(b.date) - new Date(a.date))
                .slice(0, 3);
                
            if (recentApps.length === 0) {
                recentAppsContainer.innerHTML = '<p style="color: var(--text-tertiary); text-align: center;">No applications yet.</p>';
            } else {
                recentApps.forEach(app => {
                    const appDiv = document.createElement('div');
                    appDiv.className = 'dashboard-app-card';
                    appDiv.innerHTML = `
                        <div class="dashboard-app-title">${app.title}</div>
                        <div class="dashboard-app-company">${app.company}</div>
                        <div class="dashboard-app-date">${formatDate(app.date)}</div>
                        <div class="dashboard-app-status status-${app.status.toLowerCase().replace(/\s+/g, '-')}">${app.status}</div>
                    `;
                    recentAppsContainer.appendChild(appDiv);
                });
            }
            
            // Render Dashboard Reminders
            const dashboardReminders = document.getElementById('dashboard-reminders');
            dashboardReminders.innerHTML = '';
            
            const reminders = applications
                .filter(app => app.status === 'Applied' && daysSince(app.date) > 10)
                .slice(0, 3);
                
            if (reminders.length === 0) {
                dashboardReminders.innerHTML = '<p style="color: var(--text-tertiary); text-align: center;">No follow-up reminders at this time.</p>';
            } else {
                reminders.forEach(app => {
                    const reminderDiv = document.createElement('div');
                    reminderDiv.className = 'dashboard-reminder';
                    reminderDiv.innerHTML = `
                        <div class="dashboard-reminder-title">${app.company} - ${app.title}</div>
                        <div class="dashboard-reminder-days">Applied ${daysSince(app.date)} days ago</div>
                        <button onclick="markFollowed(${app.id})" class="reminder-action-btn">Follow Up</button>
                    `;
                    dashboardReminders.appendChild(reminderDiv);
                });
            }
            
            // Update dashboard goal progress
            const weeklyProgress = calculateWeeklyProgress();
            document.getElementById('dashboard-weekly-goal-progress').style.width = `${weeklyProgress.progressPercent}%`;
            document.getElementById('dashboard-weekly-apps-submitted').textContent = `${weeklyProgress.weeklyCount} applications`;
            document.getElementById('dashboard-weekly-goal-target').textContent = `Goal: ${weeklyProgress.weeklyGoal}/week`;
        }
        
        // Calculate weekly progress for dashboard
        function calculateWeeklyProgress() {
            const today = new Date();
            const weekAgo = new Date(today);
            weekAgo.setDate(today.getDate() - 7);
            
            const weeklyApps = applications.filter(app => {
                const appDate = new Date(app.date);
                return appDate >= weekAgo && appDate <= today;
            });
            
            const weeklyCount = weeklyApps.length;
            const weeklyGoal = 10;
            const progressPercent = Math.min(100, (weeklyCount / weeklyGoal) * 100);
            
            return {
                weeklyCount,
                weeklyGoal,
                progressPercent
            };
        }

        // Theme Toggle Function
        function toggleTheme() {
            const html = document.documentElement;
            const themeText = document.getElementById('theme-text');
            const currentTheme = html.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', newTheme);
            themeText.textContent = newTheme === 'dark' ? 'Light Mode' : 'Dark Mode';
            localStorage.setItem('theme', newTheme);
            if (githubData) renderProfilePage(); // Re-render charts for theme
            renderAnalytics(); // Re-render analytics charts
            updateGoalProgress(); // Re-render goal chart
        }

        // Modal Functions with Animation
        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.style.display = 'flex';
            document.body.classList.add('modal-open');
            
            // Trigger animation after display is set
            setTimeout(() => {
                modal.classList.add('active');
            }, 10);
            
            // Add escape key listener for modal
            document.addEventListener('keydown', function closeOnEsc(e) {
                if (e.key === 'Escape') {
                    closeModal(modalId);
                    document.removeEventListener('keydown', closeOnEsc);
                }
            });
            
            // Add click outside to close
            modal.addEventListener('click', function closeOnClick(e) {
                if (e.target === modal) {
                    closeModal(modalId);
                    modal.removeEventListener('click', closeOnClick);
                }
            });
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.remove('active');
            
            // Wait for animation to complete before hiding
            setTimeout(() => {
                modal.style.display = 'none';
                document.body.classList.remove('modal-open');
            }, 300);
        }

        // Navigation Functions
        function showDashboard() {
            document.getElementById('dashboard').style.display = 'block';
            document.getElementById('profile-page').style.display = 'none';
        }

        function showProfile() {
            const token = localStorage.getItem('githubToken');
            if (token) {
                document.getElementById('dashboard').style.display = 'none';
                document.getElementById('profile-page').style.display = 'block';
                if (!githubData) {
                    fetchGitHubData(token);
                } else {
                    renderProfilePage();
                }
            } else {
                showNotification('Please log in with GitHub first.', 'error');
            }
        }

        // Toggle View Function for Applications
        function toggleView() {
            isKanbanView = document.getElementById('view-toggle').checked;
            const tableView = document.getElementById('table-view');
            const kanbanView = document.getElementById('kanban-view');
            if (isKanbanView) {
                tableView.style.display = 'none';
                kanbanView.style.display = 'grid';
                renderKanban();
            } else {
                tableView.style.display = 'block';
                kanbanView.style.display = 'none';
                renderTable();
            }
        }

        // Add Application Form Submission
        document.getElementById('app-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const app = {
                id: Date.now(),
                title: document.getElementById('title').value,
                company: document.getElementById('company').value,
                date: document.getElementById('date').value,
                status: document.getElementById('status').value,
                notes: document.getElementById('notes').value,
                url: document.getElementById('url').value,
                history: [{ date: document.getElementById('date').value, status: document.getElementById('status').value, notes: document.getElementById('notes').value }],
                salary: {
                    expected: parseFloat(document.getElementById('expected-salary').value) || 0,
                    offered: parseFloat(document.getElementById('offered-salary').value) || null,
                    benefits: ""
                },
                favorite: false
            };
            applications.push(app);
            saveData();
            if (isKanbanView) renderKanban();
            else renderTable();
            renderAnalytics();
            renderReminders();
            renderTimeline();
            updateGoalProgress();
            closeModal('app-modal');
            showNotification('Application added successfully');
        });

        // Save Job Form Submission
        document.getElementById('save-job-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const job = {
                id: Date.now(),
                title: document.getElementById('save-title').value,
                company: document.getElementById('save-company').value,
                url: document.getElementById('save-url').value,
                notes: document.getElementById('save-notes').value,
                dateSaved: new Date().toISOString().split('T')[0]
            };
            savedJobs.push(job);
            saveData();
            closeModal('save-job-modal');
            showNotification('Job saved successfully');
        });

        // Utility Functions
        function daysSince(dateString) {
            const date = new Date(dateString);
            const today = new Date();
            const diffTime = Math.abs(today - date);
            return Math.ceil(diffTime / (1000 * 60 * 60 * 24));
        }

        function formatDate(dateString) {
            return new Date(dateString).toLocaleDateString('en-US', { year: 'numeric', month: 'short', day: 'numeric' });
        }

        function formatCurrency(value) {
            if (value == null) return 'N/A';
            return new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', maximumFractionDigits: 0 }).format(value);
        }

        // Filter Applications
        function filterApplications() {
            let filteredApps = [...applications];
            const filter = document.getElementById('filter').value;
            if (filter === 'Favorites') {
                filteredApps = filteredApps.filter(app => app.favorite);
            } else if (filter !== 'All') {
                filteredApps = filteredApps.filter(app => app.status === filter);
            }

            const titleFilter = document.getElementById('filter-title').value.toLowerCase();
            const companyFilter = document.getElementById('filter-company').value.toLowerCase();
            const dateFilter = document.getElementById('filter-date').value;
            const statusFilter = document.getElementById('filter-status').value;
            const expectedFilter = parseFloat(document.getElementById('filter-expected').value) || 0;
            const offeredFilter = parseFloat(document.getElementById('filter-offered').value) || 0;
            const notesFilter = document.getElementById('filter-notes').value.toLowerCase();
            const urlFilter = document.getElementById('filter-url').value.toLowerCase();

            return filteredApps.filter(app => {
                return (
                    app.title.toLowerCase().includes(titleFilter) &&
                    app.company.toLowerCase().includes(companyFilter) &&
                    (!dateFilter || new Date(app.date) >= new Date(dateFilter)) &&
                    (!statusFilter || app.status === statusFilter) &&
                    (app.salary.expected >= expectedFilter || expectedFilter === 0) &&
                    ((app.salary.offered >= offeredFilter && app.salary.offered !== null) || offeredFilter === 0) &&
                    app.notes.toLowerCase().includes(notesFilter) &&
                    (app.url || '').toLowerCase().includes(urlFilter)
                );
            });
        }

        // Render Table View for Applications
        function renderTable() {
            const tbody = document.querySelector('#applications-table tbody');
            tbody.innerHTML = '';
            let filteredApps = filterApplications();

            filteredApps.sort((a, b) => new Date(b.date) - new Date(a.date)).forEach((app, index) => {
                const row = document.createElement('tr');
                const statusClass = {
                    'Applied': 'status-applied',
                    'Interview Scheduled': 'status-interview',
                    'Offer Received': 'status-offer',
                    'Rejected': 'status-rejected'
                }[app.status] || '';
                
                // Add staggered animation
                row.classList.add('fade-in');
                row.style.animationDelay = `${index * 30}ms`;
                
                // Add favorite row styling
                if (app.favorite) {
                    row.style.background = 'rgba(255, 215, 0, 0.05)';
                }
                
                row.innerHTML = `
                    <td>${app.title}</td>
                    <td>${app.company}</td>
                    <td>${formatDate(app.date)}</td>
                    <td><span class="status ${statusClass}" title="${app.status}">${app.status}</span></td>
                    <td>${formatCurrency(app.salary.expected)}</td>
                    <td>${formatCurrency(app.salary.offered)}</td>
                    <td>${app.notes}</td>
                    <td>${app.url ? `<a href="${app.url}" target="_blank" class="hover-glow">View</a>` : ''}</td>
                    <td>
                        <button onclick="viewDetails(${app.id})" class="action-btn hover-lift" title="View application details">Details</button>
                        <button onclick="startEdit(${app.id})" class="action-btn hover-lift" title="Edit application">Edit</button>
                        <button onclick="deleteApplication(${app.id})" class="action-btn hover-lift" title="Delete application">Delete</button>
                        <button onclick="toggleFavorite(${app.id})" class="action-btn favorite-btn ${app.favorite ? 'active' : ''}" title="${app.favorite ? 'Remove from favorites' : 'Add to favorites'}">${app.favorite ? '★' : '☆'}</button>
                        ${app.status === 'Applied' && daysSince(app.date) > 10 ? `<button onclick="markFollowed(${app.id})" class="action-btn hover-lift pulse" title="Mark as followed up">Follow Up</button>` : ''}
                    </td>
                `;
                tbody.appendChild(row);
            });

            if (filteredApps.length === 0) {
                tbody.innerHTML = `<tr><td colspan="9" style="text-align: center; padding: 2rem; color: var(--text-tertiary);">No applications found.</td></tr>`;
            }
        }

        const statusToIdSuffix = {
            'Applied': 'applied',
            'Interview Scheduled': 'interview',
            'Offer Received': 'offer',
            'Rejected': 'rejected'
        };

        // Render Kanban View for Applications with Pagination/Infinite Scroll
        function renderKanban() {
            const statuses = ['Applied', 'Interview Scheduled', 'Offer Received', 'Rejected'];
            let filteredApps = filterApplications();
            const ITEMS_PER_PAGE = 5; // Number of items to show initially and load more

            statuses.forEach(status => {
                const container = document.getElementById(`kanban-${statusToIdSuffix[status]}`);
                if (!container) {
                    console.error(`Kanban container not found for status: ${status}`);
                    return;
                }
                container.innerHTML = '';
                
                const appsInStatus = filteredApps.filter(app => app.status === status);
                const columnHeader = container.parentElement.querySelector('h3');
                
                // Add count badge to the column header
                columnHeader.innerHTML = `${status} <span class="count">${appsInStatus.length}</span>`;
                
                // If no apps, show message
                if (appsInStatus.length === 0) {
                    container.innerHTML = `<p style="color: var(--text-tertiary); text-align: center;">No applications</p>`;
                    return;
                }
                
                // Otherwise, render the first batch of cards with animation staggering
                const initialItems = appsInStatus.slice(0, ITEMS_PER_PAGE);
                initialItems.forEach((app, index) => {
                    addKanbanCard(container, app, index * 50); // Stagger animation by 50ms per card
                });
                
                // If there are more items, add "Load More" button
                if (appsInStatus.length > ITEMS_PER_PAGE) {
                    const loadMoreBtn = document.createElement('div');
                    loadMoreBtn.className = 'kanban-load-more';
                    loadMoreBtn.textContent = `Load ${Math.min(ITEMS_PER_PAGE, appsInStatus.length - ITEMS_PER_PAGE)} more`;
                    loadMoreBtn.dataset.page = '1';
                    loadMoreBtn.dataset.status = status;
                    loadMoreBtn.addEventListener('click', loadMoreKanbanItems);
                    container.appendChild(loadMoreBtn);
                }
            });
        }
        
        // Function to add a single kanban card with animation
        function addKanbanCard(container, app, delay = 0) {
            const card = document.createElement('div');
            card.className = `kanban-card ${app.favorite ? 'favorite' : ''}`;
            card.innerHTML = `
                <div class="title">${app.title}</div>
                <div class="company">${app.company}</div>
                <div class="actions">
                    <button onclick="viewDetails(${app.id})" class="action-btn" title="View application details">Details</button>
                    <button onclick="startEdit(${app.id})" class="action-btn" title="Edit application">Edit</button>
                    <button onclick="deleteApplication(${app.id})" class="action-btn" title="Delete application">Delete</button>
                    <button onclick="toggleFavorite(${app.id})" class="action-btn favorite-btn ${app.favorite ? 'active' : ''}" title="${app.favorite ? 'Remove from favorites' : 'Add to favorites'}">${app.favorite ? '★' : '☆'}</button>
                </div>
            `;
            
            // Hide initially for animation
            card.style.opacity = '0';
            card.style.transform = 'translateY(10px)';
            
            container.appendChild(card);
            
            // Trigger animation after a delay
            setTimeout(() => {
                card.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
                card.style.opacity = '1';
                card.style.transform = 'translateY(0)';
            }, delay);
        }
        
        // Function to load more kanban items when button is clicked
        function loadMoreKanbanItems(e) {
            const btn = e.currentTarget;
            const status = btn.dataset.status;
            const page = parseInt(btn.dataset.page);
            const container = btn.parentElement;
            const ITEMS_PER_PAGE = 5;
            
            // Remove the button temporarily
            btn.remove();
            
            // Get filtered applications of this status
            const appsInStatus = filterApplications().filter(app => app.status === status);
            
            // Calculate start and end indices for this page
            const startIndex = page * ITEMS_PER_PAGE;
            const endIndex = Math.min(startIndex + ITEMS_PER_PAGE, appsInStatus.length);
            
            // Add the next batch of cards with animation
            const nextItems = appsInStatus.slice(startIndex, endIndex);
            nextItems.forEach((app, index) => {
                addKanbanCard(container, app, index * 50);
            });
            
            // If there are still more items, add the button back
            if (endIndex < appsInStatus.length) {
                btn.textContent = `Load ${Math.min(ITEMS_PER_PAGE, appsInStatus.length - endIndex)} more`;
                btn.dataset.page = (page + 1).toString();
                setTimeout(() => {
                    container.appendChild(btn);
                }, nextItems.length * 50 + 100); // Add button after all cards are added
            }
        }

        // Toggle Favorite Status with Animation
        function toggleFavorite(id) {
            const app = applications.find(a => a.id === id);
            if (app) {
                app.favorite = !app.favorite;
                saveData();
                
                // Find all instances of this app in the UI and update them
                if (isKanbanView) {
                    // Find and update kanban card
                    const kanbanCards = document.querySelectorAll('.kanban-card');
                    kanbanCards.forEach(card => {
                        const actionButtons = card.querySelectorAll('.actions button');
                        const favoriteBtn = actionButtons[actionButtons.length - 1];
                        if (favoriteBtn && favoriteBtn.getAttribute('onclick').includes(`toggleFavorite(${id})`)) {
                            // Update card class
                            if (app.favorite) {
                                card.classList.add('favorite');
                                card.classList.add('bounce'); // Add bounce animation
                                setTimeout(() => card.classList.remove('bounce'), 500); // Remove after animation completes
                            } else {
                                card.classList.remove('favorite');
                                card.classList.add('shake'); // Add shake animation
                                setTimeout(() => card.classList.remove('shake'), 500); // Remove after animation completes
                            }
                            
                            // Update button
                            favoriteBtn.innerHTML = app.favorite ? '★' : '☆';
                            favoriteBtn.title = app.favorite ? 'Remove from favorites' : 'Add to favorites';
                            favoriteBtn.className = `action-btn favorite-btn ${app.favorite ? 'active' : ''}`;
                        }
                    });
                } else {
                    // Find and update table row
                    const tableRows = document.querySelectorAll('#applications-table tbody tr');
                    tableRows.forEach(row => {
                        const cells = row.querySelectorAll('td');
                        const actionCell = cells[cells.length - 1];
                        const favoriteBtn = actionCell.querySelector(`button[onclick*="toggleFavorite(${id})"]`);
                        if (favoriteBtn) {
                            favoriteBtn.innerHTML = app.favorite ? '★' : '☆';
                            favoriteBtn.title = app.favorite ? 'Remove from favorites' : 'Add to favorites';
                            favoriteBtn.className = `action-btn favorite-btn ${app.favorite ? 'active' : ''}`;
                            
                            if (app.favorite) {
                                row.classList.add('flash');
                                setTimeout(() => row.classList.remove('flash'), 500);
                            }
                        }
                    });
                }
                
                showNotification(app.favorite ? 'Application favorited' : 'Application unfavorited');
            }
        }

        function viewDetails(id) {
            const app = applications.find(a => a.id === id);
            if (app) {
                document.getElementById('detail-title').textContent = app.title;
                document.getElementById('detail-company').textContent = app.company;
                document.getElementById('detail-date').textContent = formatDate(app.date);
                document.getElementById('detail-status').textContent = app.status;
                document.getElementById('detail-expected').textContent = formatCurrency(app.salary.expected);
                document.getElementById('detail-offered').textContent = formatCurrency(app.salary.offered);
                document.getElementById('detail-notes').textContent = app.notes || 'N/A';
                const urlContainer = document.getElementById('detail-url-container');
                if (app.url) {
                    urlContainer.innerHTML = `<a href="${app.url}" target="_blank">View</a>`;
                } else {
                    urlContainer.textContent = 'N/A';
                }
                renderTimeline(app, 'detail-timeline');
                openModal('details-modal');
            }
        }

        // Edit Application using Modal instead of prompt
        function startEdit(id) {
            const app = applications.find(a => a.id === id);
            if (app) {
                // Create an edit modal dynamically
                const editModalId = 'edit-modal-' + id;
                let editModal = document.getElementById(editModalId);
                
                // If modal doesn't exist, create it
                if (!editModal) {
                    editModal = document.createElement('div');
                    editModal.id = editModalId;
                    editModal.className = 'modal';
                    
                    const modalHtml = `
                        <div class="modal-content">
                            <button class="modal-close" onclick="closeModal('${editModalId}')">×</button>
                            <h2>Edit Application</h2>
                            <form id="edit-form-${id}">
                                <div class="form-group">
                                    <label for="edit-title-${id}">Job Title</label>
                                    <input type="text" id="edit-title-${id}" value="${app.title}" required>
                                </div>
                                <div class="form-group">
                                    <label for="edit-company-${id}">Company</label>
                                    <input type="text" id="edit-company-${id}" value="${app.company}" required>
                                </div>
                                <div class="form-group">
                                    <label for="edit-date-${id}">Date</label>
                                    <input type="date" id="edit-date-${id}" value="${app.date}" required>
                                </div>
                                <div class="form-group">
                                    <label for="edit-status-${id}">Status</label>
                                    <select id="edit-status-${id}">
                                        <option value="Applied" ${app.status === 'Applied' ? 'selected' : ''}>Applied</option>
                                        <option value="Interview Scheduled" ${app.status === 'Interview Scheduled' ? 'selected' : ''}>Interview Scheduled</option>
                                        <option value="Offer Received" ${app.status === 'Offer Received' ? 'selected' : ''}>Offer Received</option>
                                        <option value="Rejected" ${app.status === 'Rejected' ? 'selected' : ''}>Rejected</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="edit-expected-${id}">Expected Salary</label>
                                    <input type="number" id="edit-expected-${id}" value="${app.salary?.expected || ''}" placeholder="$">
                                </div>
                                <div class="form-group">
                                    <label for="edit-offered-${id}">Offered Salary</label>
                                    <input type="number" id="edit-offered-${id}" value="${app.salary?.offered || ''}" placeholder="$">
                                </div>
                                <div class="form-group">
                                    <label for="edit-notes-${id}">Notes</label>
                                    <textarea id="edit-notes-${id}">${app.notes || ''}</textarea>
                                </div>
                                <div class="form-group">
                                    <label for="edit-url-${id}">URL</label>
                                    <input type="url" id="edit-url-${id}" value="${app.url || ''}">
                                </div>
                                <button type="submit" class="btn-primary">Save Changes</button>
                            </form>
                        </div>
                    `;
                    
                    editModal.innerHTML = modalHtml;
                    document.body.appendChild(editModal);
                    
                    // Add form submission handler
                    document.getElementById(`edit-form-${id}`).addEventListener('submit', function(e) {
                        e.preventDefault();
                        
                        const prevStatus = app.status;
                        const newStatus = document.getElementById(`edit-status-${id}`).value;
                        
                        // Update app data
                        app.title = document.getElementById(`edit-title-${id}`).value;
                        app.company = document.getElementById(`edit-company-${id}`).value;
                        app.date = document.getElementById(`edit-date-${id}`).value;
                        app.status = newStatus;
                        app.notes = document.getElementById(`edit-notes-${id}`).value;
                        app.url = document.getElementById(`edit-url-${id}`).value;
                        
                        // Update salary information
                        if (!app.salary) app.salary = {};
                        app.salary.expected = parseFloat(document.getElementById(`edit-expected-${id}`).value) || 0;
                        app.salary.offered = parseFloat(document.getElementById(`edit-offered-${id}`).value) || null;
                        
                        // Add to history if status changed
                        if (newStatus !== prevStatus) {
                            if (!app.history) app.history = [];
                            app.history.push({
                                date: new Date().toISOString().split('T')[0],
                                status: newStatus,
                                notes: `Status changed from ${prevStatus} to ${newStatus}`
                            });
                        }
                        
                        saveData();
                        
                        // Update UI
                        if (isKanbanView) renderKanban();
                        else renderTable();
                        renderAnalytics();
                        renderReminders();
                        renderTimeline();
                        updateGoalProgress();
                        
                        closeModal(editModalId);
                        showNotification('Application updated successfully', 'success');
                    });
                }
                
                // Open the modal
                openModal(editModalId);
            }
        }

        // Delete Application
        function deleteApplication(id) {
            if (confirm('Are you sure you want to delete this application?')) {
                applications = applications.filter(a => a.id !== id);
                saveData();
                if (isKanbanView) renderKanban();
                else renderTable();
                renderAnalytics();
                renderReminders();
                renderTimeline();
                updateGoalProgress();
                showNotification('Application deleted');
            }
        }

        // Mark as Followed Up
        function markFollowed(id) {
            const app = applications.find(a => a.id === id);
            if (app) {
                const today = new Date().toISOString().split('T')[0];
                app.notes += ` - Followed up on ${today}`;
                app.history.push({ date: today, status: app.status, notes: 'Followed up on application' });
                saveData();
                if (isKanbanView) renderKanban();
                else renderTable();
                renderAnalytics();
                renderReminders();
                renderTimeline();
            }
        }

        // Save Data to LocalStorage
        function saveData() {
            localStorage.setItem('jobApplications', JSON.stringify(applications));
            localStorage.setItem('savedJobs', JSON.stringify(savedJobs));
        }

        // Show Notification with Animation
        function showNotification(message, type = 'success') {
            // Remove any existing notifications to prevent stacking
            const existingNotifications = document.querySelectorAll('.notification');
            existingNotifications.forEach(notification => {
                notification.classList.add('notification-exit');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                }, 300);
            });
            
            // Create new notification
            const flash = document.createElement('div');
            flash.className = 'notification notification-enter';
            
            // Set background based on type
            const bgColor = type === 'success' ? 'rgba(0, 240, 255, 0.2)' : 'rgba(244, 67, 54, 0.2)';
            const borderColor = type === 'success' ? 'var(--accent-primary)' : 'var(--status-rejected)';
            const icon = type === 'success' ? '✓' : '✗';
            
            flash.style.cssText = `
                position: fixed; top: 20px; right: 20px; padding: 12px 20px 12px 40px;
                background: ${bgColor}; backdrop-filter: blur(10px); 
                border-radius: 6px; color: white; font-weight: 500; z-index: 1000;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
                border-left: 3px solid ${borderColor};
                transform: translateX(50px); opacity: 0;
                transition: transform 0.3s ease, opacity 0.3s ease;
            `;
            
            // Add icon
            const iconSpan = document.createElement('span');
            iconSpan.style.cssText = `
                position: absolute; left: 12px; top: 50%; transform: translateY(-50%);
                font-size: 1.2em; color: ${borderColor};
            `;
            iconSpan.textContent = icon;
            
            flash.appendChild(iconSpan);
            
            // Add message
            const messageSpan = document.createElement('span');
            messageSpan.textContent = message;
            flash.appendChild(messageSpan);
            
            // Add close button
            const closeBtn = document.createElement('span');
            closeBtn.style.cssText = `
                position: absolute; right: 8px; top: 50%; transform: translateY(-50%);
                cursor: pointer; font-size: 1em; opacity: 0.7; transition: opacity 0.2s ease;
                width: 20px; height: 20px; text-align: center; line-height: 20px;
            `;
            closeBtn.textContent = '×';
            closeBtn.addEventListener('mouseenter', () => { closeBtn.style.opacity = '1'; });
            closeBtn.addEventListener('mouseleave', () => { closeBtn.style.opacity = '0.7'; });
            closeBtn.addEventListener('click', () => {
                flash.classList.add('notification-exit');
                setTimeout(() => {
                    if (flash.parentNode) {
                        flash.parentNode.removeChild(flash);
                    }
                }, 300);
            });
            
            flash.appendChild(closeBtn);
            
            // Add to document
            document.body.appendChild(flash);
            
            // Trigger entrance animation
            setTimeout(() => {
                flash.style.transform = 'translateX(0)';
                flash.style.opacity = '1';
            }, 10);
            
            // Auto-dismiss
            setTimeout(() => {
                flash.classList.add('notification-exit');
                setTimeout(() => {
                    if (flash.parentNode) {
                        flash.parentNode.removeChild(flash);
                    }
                }, 300);
            }, 3000);
        }
        
        // Add notification animation styles
        const notificationStyle = document.createElement('style');
        notificationStyle.textContent = `
            .notification-enter {
                animation: notification-enter 0.3s ease forwards;
            }
            .notification-exit {
                animation: notification-exit 0.3s ease forwards;
            }
            @keyframes notification-enter {
                from { transform: translateX(50px); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes notification-exit {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(50px); opacity: 0; }
            }
        `;
        document.head.appendChild(notificationStyle);

        // World-Class Job Search Analytics With Relevant Metrics
        function renderAnalytics() {
            // Get the filtered time range
            const timeRange = document.getElementById('analytics-time-range')?.value || 'month';
            const filteredApps = getFilteredAppsByTimeRange(applications, timeRange);
            
            // Render Application Status Dashboard
            renderApplicationStatusDashboard(filteredApps);
            
            // Render Application Pipeline
            renderApplicationPipeline(filteredApps);
            
            // Render Application Activity
            renderApplicationActivity(filteredApps);
            
            // Render Remote Job Insights
            renderRemoteJobInsights(filteredApps);
            
            // Render Salary Insights
            renderSalaryInsights(filteredApps);
            
            // Render Application Source Analysis
            renderApplicationSourceAnalysis(filteredApps);
            
            // Render Actionable Recommendations
            renderActionableRecommendations(filteredApps);
        }
        
        // Filter applications by time range
        function getFilteredAppsByTimeRange(apps, timeRange) {
            const today = new Date();
            let startDate = new Date();
            
            // Set the start date based on the selected time range
            switch (timeRange) {
                case 'week':
                    startDate.setDate(today.getDate() - 7);
                    break;
                case 'month':
                    startDate.setMonth(today.getMonth() - 1);
                    break;
                case 'quarter':
                    startDate.setMonth(today.getMonth() - 3);
                    break;
                case 'year':
                    startDate.setFullYear(today.getFullYear() - 1);
                    break;
                case 'all':
                default:
                    startDate = new Date(0); // Beginning of time
                    break;
            }
            
            return apps.filter(app => new Date(app.date) >= startDate);
        }

        // Render Application Status Dashboard
        function renderApplicationStatusDashboard(apps) {
            // Calculate previous period's data for comparison
            const prevTimeRange = getPreviousPeriod(document.getElementById('analytics-time-range')?.value || 'month');
            const prevApps = getFilteredAppsByTimeRange(applications, prevTimeRange);
            
            // Calculate total applications
            const totalApplications = apps.length;
            
            // Calculate weekly application rate
            const today = new Date();
            const oneWeekAgo = new Date(today);
            oneWeekAgo.setDate(today.getDate() - 7);
            
            const appsLastWeek = apps.filter(app => {
                const appDate = new Date(app.date);
                return appDate >= oneWeekAgo && appDate <= today;
            }).length;
            
            // Calculate active applications (those not rejected or with offers)
            const activeApplications = apps.filter(app => 
                app.status !== 'Rejected' && app.status !== 'Offer Received'
            ).length;
            
            // Calculate response rate
            const responseCount = apps.filter(app => 
                app.status !== 'Applied' || 
                app.history?.some(h => h.status !== 'Applied' && new Date(h.date) > new Date(app.date))
            ).length;
            const responseRate = totalApplications > 0 ? (responseCount / totalApplications) * 100 : 0;
            
            const prevResponseCount = prevApps.filter(app => 
                app.status !== 'Applied' || 
                app.history?.some(h => h.status !== 'Applied' && new Date(h.date) > new Date(app.date))
            ).length;
            const prevResponseRate = prevApps.length > 0 ? (prevResponseCount / prevApps.length) * 100 : 0;
            
            const responseChange = prevResponseRate > 0 ? ((responseRate - prevResponseRate) / prevResponseRate) * 100 : 0;
            
            // Calculate interview rate
            const interviewCount = apps.filter(app => 
                app.status === 'Interview Scheduled' || 
                app.status === 'Offer Received' || 
                app.history?.some(h => h.status === 'Interview Scheduled')
            ).length;
            const interviewRate = totalApplications > 0 ? (interviewCount / totalApplications) * 100 : 0;
            
            const prevInterviewCount = prevApps.filter(app => 
                app.status === 'Interview Scheduled' || 
                app.status === 'Offer Received' || 
                app.history?.some(h => h.status === 'Interview Scheduled')
            ).length;
            const prevInterviewRate = prevApps.length > 0 ? (prevInterviewCount / prevApps.length) * 100 : 0;
            
            const interviewChange = prevInterviewRate > 0 ? ((interviewRate - prevInterviewRate) / prevInterviewRate) * 100 : 0;
            
            // Calculate pending responses
            const pendingCount = apps.filter(app => app.status === 'Applied').length;
            
            // Update KPI cards
            const totalAppsEl = document.getElementById('total-applications');
            if (totalAppsEl) totalAppsEl.textContent = totalApplications;
            
            const applicationRateEl = document.getElementById('application-rate');
            if (applicationRateEl) applicationRateEl.textContent = `${appsLastWeek}/week`;
            
            const responseRateEl = document.getElementById('response-rate-value');
            if (responseRateEl) responseRateEl.textContent = `${responseRate.toFixed(1)}%`;
            
            const responseChangeEl = document.getElementById('response-rate-change');
            if (responseChangeEl) {
                const arrow = responseChangeEl.querySelector('.arrow');
                responseChangeEl.textContent = `${Math.abs(responseChange).toFixed(1)}% `;
                responseChangeEl.appendChild(arrow);
                
                if (responseChange > 0) {
                    responseChangeEl.classList.add('positive');
                    responseChangeEl.classList.remove('negative');
                    arrow.textContent = '↑';
                } else if (responseChange < 0) {
                    responseChangeEl.classList.add('negative');
                    responseChangeEl.classList.remove('positive');
                    arrow.textContent = '↓';
                } else {
                    responseChangeEl.classList.remove('positive', 'negative');
                    arrow.textContent = '→';
                }
            }
            
            const interviewRateEl = document.getElementById('interview-rate-value');
            if (interviewRateEl) interviewRateEl.textContent = `${interviewRate.toFixed(1)}%`;
            
            const interviewChangeEl = document.getElementById('interview-rate-change');
            if (interviewChangeEl) {
                const arrow = interviewChangeEl.querySelector('.arrow');
                interviewChangeEl.textContent = `${Math.abs(interviewChange).toFixed(1)}% `;
                interviewChangeEl.appendChild(arrow);
                
                if (interviewChange > 0) {
                    interviewChangeEl.classList.add('positive');
                    interviewChangeEl.classList.remove('negative');
                    arrow.textContent = '↑';
                } else if (interviewChange < 0) {
                    interviewChangeEl.classList.add('negative');
                    interviewChangeEl.classList.remove('positive');
                    arrow.textContent = '↓';
                } else {
                    interviewChangeEl.classList.remove('positive', 'negative');
                    arrow.textContent = '→';
                }
            }
            
            const activeAppsEl = document.getElementById('active-applications');
            if (activeAppsEl) activeAppsEl.textContent = activeApplications;
            
            const activeAppsChangeEl = document.getElementById('active-applications-change');
            if (activeAppsChangeEl) {
                const arrow = activeAppsChangeEl.querySelector('.arrow');
                activeAppsChangeEl.textContent = `${pendingCount} pending `;
                activeAppsChangeEl.appendChild(arrow);
            }
        }
        
        // Helper function to update KPI cards
        function updateKpiCard(cardId, value, change) {
            const card = document.getElementById(cardId);
            if (!card) return;
            
            const valueElement = card.querySelector('.kpi-value');
            const changeElement = card.querySelector('.kpi-change');
            
            if (valueElement) valueElement.textContent = value;
            
            if (changeElement) {
                const changeValue = change.toFixed(1);
                const arrow = changeElement.querySelector('.arrow');
                
                changeElement.textContent = Math.abs(changeValue) + '% ';
                changeElement.appendChild(arrow);
                
                if (change > 0) {
                    changeElement.classList.add('positive');
                    changeElement.classList.remove('negative');
                    arrow.textContent = '↑';
                } else if (change < 0) {
                    changeElement.classList.add('negative');
                    changeElement.classList.remove('positive');
                    arrow.textContent = '↓';
                } else {
                    changeElement.classList.remove('positive', 'negative');
                    arrow.textContent = '→';
                }
            }
        }
        
        // Get previous period based on current period
        function getPreviousPeriod(timeRange) {
            switch (timeRange) {
                case 'week':
                    return 'prev-week';
                case 'month':
                    return 'prev-month';
                case 'quarter':
                    return 'prev-quarter';
                case 'year':
                    return 'prev-year';
                default:
                    return 'all';
            }
        }

        // Render Application Pipeline
        function renderApplicationPipeline(apps) {
            const appliedCount = apps.filter(app => app.status === 'Applied' || app.history?.some(h => h.status === 'Applied')).length;
            const responseCount = apps.filter(app => 
                app.status !== 'Applied' || 
                app.history?.some(h => h.status !== 'Applied' && new Date(h.date) > new Date(app.date))
            ).length;
            const interviewCount = apps.filter(app => app.status === 'Interview Scheduled' || app.status === 'Offer Received' || app.history?.some(h => h.status === 'Interview Scheduled')).length;
            const offerCount = apps.filter(app => app.status === 'Offer Received').length;
            const rejectedCount = apps.filter(app => app.status === 'Rejected').length;
            
            // Calculate funnel metrics
            const timeToResponse = calculateAverageTimeToStatus(apps, 'Applied', status => status !== 'Applied');
            const timeToInterview = calculateAverageTimeToStatus(apps, 'Applied', status => status === 'Interview Scheduled');
            const timeToOffer = calculateAverageTimeToStatus(apps, 'Applied', status => status === 'Offer Received');
            const avgCycleTime = calculateAverageCycleTime(apps);
            
            // Update funnel metrics
            document.getElementById('time-to-response').textContent = timeToResponse.toFixed(1) + ' days';
            document.getElementById('time-to-interview').textContent = timeToInterview.toFixed(1) + ' days';
            document.getElementById('time-to-offer').textContent = timeToOffer.toFixed(1) + ' days';
            document.getElementById('avg-cycle-time').textContent = avgCycleTime.toFixed(1) + ' days';
            
            // Render Sankey Diagram
            renderSankeyDiagram(appliedCount, responseCount, interviewCount, offerCount, rejectedCount);
            
            // Render Cyberpunk Funnel Chart
            renderCyberpunkFunnel(appliedCount, responseCount, interviewCount, offerCount);
        }
        
        // Render Sankey Diagram for Application Flow
        function renderSankeyDiagram(appliedCount, responseCount, interviewCount, offerCount, rejectedCount) {
            // Clear previous diagram
            d3.select("#sankey-diagram").html("");
            
            // Calculate values for the diagram
            // These values are approximations as Sankey requires specific flow values
            const noResponseCount = Math.max(0, appliedCount - responseCount);
            const responseNoInterviewCount = Math.max(0, responseCount - interviewCount);
            const interviewNoOfferCount = Math.max(0, interviewCount - offerCount);
            
            // Define the nodes
            const nodes = [
                { name: "Applications" },
                { name: "Responses" },
                { name: "Interviews" },
                { name: "Offers" },
                { name: "No Response" },
                { name: "Rejected" }
            ];
            
            // Define the links
            const links = [
                { source: 0, target: 1, value: responseCount },
                { source: 0, target: 4, value: noResponseCount },
                { source: 1, target: 2, value: interviewCount },
                { source: 1, target: 5, value: responseNoInterviewCount },
                { source: 2, target: 3, value: offerCount },
                { source: 2, target: 5, value: interviewNoOfferCount }
            ];
            
            // Set up the dimensions and margins
            const margin = { top: 10, right: 10, bottom: 10, left: 10 };
            const width = document.getElementById("sankey-diagram").clientWidth - margin.left - margin.right;
            const height = 280 - margin.top - margin.bottom;
            
            // Create the SVG
            const svg = d3.select("#sankey-diagram")
                .append("svg")
                .attr("width", width + margin.left + margin.right)
                .attr("height", height + margin.top + margin.bottom)
                .append("g")
                .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
            
            // Create the Sankey generator
            const sankey = d3.sankey()
                .nodeWidth(20)
                .nodePadding(10)
                .extent([[1, 1], [width - 1, height - 5]]);
            
            // Generate the diagram
            const graph = sankey({
                nodes: nodes.map(d => Object.assign({}, d)),
                links: links.map(d => Object.assign({}, d))
            });
            
            // Define the link gradient colors for cyberpunk aesthetic
            const linkColors = [
                { source: "Applications", target: "Responses", color: "#00f0ff" }, // accent-primary
                { source: "Applications", target: "No Response", color: "#ff2a6d" }, // accent-tertiary
                { source: "Responses", target: "Interviews", color: "#9d00ff" }, // accent-secondary
                { source: "Responses", target: "Rejected", color: "#ff2a6d" }, // accent-tertiary
                { source: "Interviews", target: "Offers", color: "#05ffa1" }, // accent-quaternary
                { source: "Interviews", target: "Rejected", color: "#ff2a6d" } // accent-tertiary
            ];
            
            // Add gradient definitions
            const defs = svg.append("defs");
            
            graph.links.forEach((link, i) => {
                const gradientId = "gradient-" + i;
                const sourceNode = nodes[link.source.index].name;
                const targetNode = nodes[link.target.index].name;
                
                const foundColor = linkColors.find(c => 
                    c.source === sourceNode && c.target === targetNode
                );
                
                const color = foundColor ? foundColor.color : "#00f0ff";
                
                const gradient = defs.append("linearGradient")
                    .attr("id", gradientId)
                    .attr("gradientUnits", "userSpaceOnUse")
                    .attr("x1", link.source.x1)
                    .attr("y1", link.source.y0)
                    .attr("x2", link.target.x0)
                    .attr("y2", link.target.y1);
                
                gradient.append("stop")
                    .attr("offset", "0%")
                    .attr("stop-color", color)
                    .attr("stop-opacity", 0.8);
                
                gradient.append("stop")
                    .attr("offset", "100%")
                    .attr("stop-color", "#000000")
                    .attr("stop-opacity", 0.3);
            });
            
            // Add the links
            svg.append("g")
                .selectAll("path")
                .data(graph.links)
                .enter()
                .append("path")
                .attr("class", "link")
                .attr("d", d3.sankeyLinkHorizontal())
                .attr("stroke", (d, i) => "url(#gradient-" + i + ")")
                .attr("stroke-width", d => Math.max(1, d.width))
                .style("stroke-opacity", 0.5)
                .on("mouseover", function() {
                    d3.select(this).style("stroke-opacity", 0.8);
                })
                .on("mouseout", function() {
                    d3.select(this).style("stroke-opacity", 0.5);
                });
            
            // Node fill colors
            const nodeColors = {
                "Applications": "#00f0ff", // accent-primary
                "Responses": "#9d00ff",    // accent-secondary
                "Interviews": "#05ffa1",   // accent-quaternary
                "Offers": "#05ffa1",       // accent-quaternary
                "No Response": "#ff2a6d",  // accent-tertiary
                "Rejected": "#ff2a6d"      // accent-tertiary
            };
            
            // Add the nodes
            const node = svg.append("g")
                .selectAll("g")
                .data(graph.nodes)
                .enter()
                .append("g")
                .attr("class", "node");
            
            // Node rectangles
            node.append("rect")
                .attr("x", d => d.x0)
                .attr("y", d => d.y0)
                .attr("height", d => d.y1 - d.y0)
                .attr("width", d => d.x1 - d.x0)
                .attr("fill", d => nodeColors[d.name] || "#00f0ff")
                .attr("opacity", 0.8)
                .attr("stroke", "#000")
                .attr("stroke-width", 1)
                .append("title")
                .text(d => d.name + "\n" + d.value);
            
            // Add the node labels
            node.append("text")
                .attr("x", d => d.x0 < width / 2 ? d.x1 + 6 : d.x0 - 6)
                .attr("y", d => (d.y1 + d.y0) / 2)
                .attr("dy", "0.35em")
                .attr("text-anchor", d => d.x0 < width / 2 ? "start" : "end")
                .text(d => d.name + " (" + d.value + ")")
                .attr("font-family", "'Space Mono', monospace")
                .attr("font-size", "12px")
                .attr("fill", "white")
                .attr("stroke", "none")
                .style("text-shadow", "0 0 3px #00f0ff");
        }
        
        // Render Cyberpunk Funnel Chart
        function renderCyberpunkFunnel(appliedCount, responseCount, interviewCount, offerCount) {
            // Clear previous diagram
            d3.select("#funnel-chart-container").html("");
            
            // Set up dimensions
            const margin = { top: 20, right: 20, bottom: 30, left: 20 };
            const width = document.getElementById("funnel-chart-container").clientWidth - margin.left - margin.right;
            const height = 250 - margin.top - margin.bottom;
            
            // Create the SVG
            const svg = d3.select("#funnel-chart-container")
                .append("svg")
                .attr("width", width + margin.left + margin.right)
                .attr("height", height + margin.top + margin.bottom)
                .append("g")
                .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
            
            // Funnel data
            const data = [
                { stage: "Applied", value: appliedCount },
                { stage: "Responses", value: responseCount },
                { stage: "Interviews", value: interviewCount },
                { stage: "Offers", value: offerCount }
            ];
            
            // Calculate funnel properties
            const stageHeight = height / data.length;
            const maxValue = d3.max(data, d => d.value);
            const maxWidth = width * 0.8;
            const xScale = d3.scaleLinear()
                .domain([0, maxValue])
                .range([0, maxWidth]);
            
            // Define the gradient
            const defs = svg.append("defs");
            
            const stageColors = [
                { offset: "0%", color: "#00f0ff" }, // accent-primary
                { offset: "33%", color: "#9d00ff" }, // accent-secondary
                { offset: "66%", color: "#ff2a6d" }, // accent-tertiary
                { offset: "100%", color: "#05ffa1" }  // accent-quaternary
            ];
            
            // Create gradient for each stage
            data.forEach((d, i) => {
                const gradientId = "funnel-gradient-" + i;
                
                const gradient = defs.append("linearGradient")
                    .attr("id", gradientId)
                    .attr("x1", "0%")
                    .attr("y1", "0%")
                    .attr("x2", "100%")
                    .attr("y2", "0%");
                
                gradient.append("stop")
                    .attr("offset", "0%")
                    .attr("stop-color", stageColors[i % stageColors.length].color)
                    .attr("stop-opacity", 0.9);
                
                gradient.append("stop")
                    .attr("offset", "100%")
                    .attr("stop-color", stageColors[(i + 1) % stageColors.length].color)
                    .attr("stop-opacity", 0.7);
                
                // Add a glow filter
                const filter = defs.append("filter")
                    .attr("id", "glow" + i)
                    .attr("x", "-50%")
                    .attr("y", "-50%")
                    .attr("width", "200%")
                    .attr("height", "200%");
                
                filter.append("feGaussianBlur")
                    .attr("stdDeviation", "3")
                    .attr("result", "coloredBlur");
                
                const feMerge = filter.append("feMerge");
                feMerge.append("feMergeNode")
                    .attr("in", "coloredBlur");
                feMerge.append("feMergeNode")
                    .attr("in", "SourceGraphic");
            });
            
            // Draw the funnel stages
            data.forEach((d, i) => {
                const y = i * stageHeight;
                let topWidth, bottomWidth;
                
                // Calculate trapezoid dimensions
                if (i === 0) {
                    topWidth = xScale(d.value);
                    bottomWidth = i < data.length - 1 ? xScale(data[i + 1].value) : topWidth;
                } else {
                    topWidth = xScale(data[i - 1].value);
                    bottomWidth = xScale(d.value);
                }
                
                // Adjust for first stage
                if (i === 0) bottomWidth = xScale(d.value);
                
                // Create the trapezoid path
                const points = [
                    [(width - topWidth) / 2, y],
                    [(width + topWidth) / 2, y],
                    [(width + bottomWidth) / 2, y + stageHeight],
                    [(width - bottomWidth) / 2, y + stageHeight]
                ];
                
                // Draw the trapezoid
                svg.append("polygon")
                    .attr("class", "funnel-stage")
                    .attr("points", points.map(p => p.join(",")).join(" "))
                    .attr("fill", "url(#funnel-gradient-" + i + ")")
                    .attr("filter", "url(#glow" + i + ")")
                    .on("mouseover", function() {
                        d3.select(this).attr("filter", "url(#glow" + i + ")");
                    })
                    .on("mouseout", function() {
                        d3.select(this).attr("filter", "none");
                    });
                
                // Add the stage label
                svg.append("text")
                    .attr("class", "funnel-label")
                    .attr("x", width / 2)
                    .attr("y", y + stageHeight / 2 - 6)
                    .text(d.stage);
                
                // Add the value
                svg.append("text")
                    .attr("class", "funnel-value")
                    .attr("x", width / 2)
                    .attr("y", y + stageHeight / 2 + 12)
                    .text(d.value);
                
                // Add conversion rate if not first stage
                if (i > 0) {
                    const conversionRate = ((d.value / data[i - 1].value) * 100 || 0).toFixed(1);
                    
                    svg.append("text")
                        .attr("class", "funnel-rate")
                        .attr("x", width / 2)
                        .attr("y", y + 5)
                        .attr("text-anchor", "middle")
                        .attr("fill", "#ff00ff")
                        .attr("font-size", "10px")
                        .attr("font-family", "'Space Mono', monospace")
                        .style("text-shadow", "0 0 3px #ff00ff")
                        .text("▼ " + conversionRate + "%");
                }
            });
        }
        
        // Calculate average time between status changes
        function calculateAverageTimeToStatus(apps, fromStatus, toStatusFn) {
            const timeDiffs = [];
            
            apps.forEach(app => {
                if (!app.history || app.history.length < 2) return;
                
                // Sort history by date
                const sortedHistory = [...app.history].sort((a, b) => new Date(a.date) - new Date(b.date));
                
                // Find from status entry
                const fromEntry = sortedHistory.find(h => h.status === fromStatus);
                if (!fromEntry) return;
                
                // Find to status entry
                const toEntry = sortedHistory.find(h => toStatusFn(h.status) && new Date(h.date) > new Date(fromEntry.date));
                if (!toEntry) return;
                
                // Calculate time difference in days
                const fromDate = new Date(fromEntry.date);
                const toDate = new Date(toEntry.date);
                const diffTime = Math.abs(toDate - fromDate);
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                
                timeDiffs.push(diffDays);
            });
            
            // Return average or 0 if no data
            return timeDiffs.length > 0 ? timeDiffs.reduce((sum, days) => sum + days, 0) / timeDiffs.length : 0;
        }
        
        // Calculate average cycle time from applied to final status
        function calculateAverageCycleTime(apps) {
            const cycleTimes = [];
            
            apps.forEach(app => {
                if (!app.history || app.history.length < 2) return;
                
                // Sort history by date
                const sortedHistory = [...app.history].sort((a, b) => new Date(a.date) - new Date(b.date));
                
                // Get first and last entry
                const firstEntry = sortedHistory[0];
                const lastEntry = sortedHistory[sortedHistory.length - 1];
                
                // Calculate time difference in days
                const firstDate = new Date(firstEntry.date);
                const lastDate = new Date(lastEntry.date);
                const diffTime = Math.abs(lastDate - firstDate);
                const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                
                cycleTimes.push(diffDays);
            });
            
            // Return average or 0 if no data
            return cycleTimes.length > 0 ? cycleTimes.reduce((sum, days) => sum + days, 0) / cycleTimes.length : 0;
        }

        // Render Application Activity
        function renderApplicationActivity(apps) {
            // Prepare data for trend chart
            const dates = getLast8Weeks();
            const appCounts = countApplicationsByWeek(apps, dates);
            const responseCounts = countResponsesByWeek(apps, dates);
            const interviewCounts = countInterviewsByWeek(apps, dates);
            const labels = dates.map(date => `Week of ${formatDate(date)}`);
            
            // Calculate weekly application goal (aiming for 10/week)
            const weeklyGoal = 10;
            const currentWeek = appCounts[appCounts.length - 1];
            document.getElementById('weekly-app-goal').textContent = weeklyGoal;
            document.getElementById('current-weekly-rate').textContent = currentWeek;
            
            // Determine peak application day
            const dayOfWeekCounts = countApplicationsByDayOfWeek(apps);
            const daySuccessRates = calculateDaySuccessRates(apps);
            const peakDay = getKeyWithHighestValue(daySuccessRates);
            document.getElementById('peak-day').textContent = getDayName(peakDay);
            
            // Analyze job board success rates
            const jobBoardStats = analyzeJobBoardSuccessRates(apps);
            let bestJobBoard = "None";
            let bestRate = 0;
            
            if (jobBoardStats.length > 0) {
                const topJobBoard = jobBoardStats[0];
                bestJobBoard = topJobBoard.source;
                bestRate = topJobBoard.responseRate * 100;
            }
            
            document.getElementById('best-job-board').textContent = bestJobBoard;
            document.getElementById('best-job-board-rate').textContent = `${bestRate.toFixed(0)}%`;
            
            // Create trends chart
            const trendsChartCtx = document.getElementById('application-trends-chart').getContext('2d');
            if (window.trendsChart) window.trendsChart.destroy();
            
            // Create gradients for cyberpunk styling
            const createGradient = (ctx, colorStart, colorEnd) => {
                const gradient = ctx.createLinearGradient(0, 0, 0, 400);
                gradient.addColorStop(0, colorStart);
                gradient.addColorStop(1, colorEnd);
                return gradient;
            };
            
            const appliedGradient = createGradient(trendsChartCtx, 'rgba(0, 240, 255, 0.7)', 'rgba(0, 240, 255, 0.1)');
            const responsesGradient = createGradient(trendsChartCtx, 'rgba(157, 0, 255, 0.7)', 'rgba(157, 0, 255, 0.1)');
            const interviewsGradient = createGradient(trendsChartCtx, 'rgba(5, 255, 161, 0.7)', 'rgba(5, 255, 161, 0.1)');
            
            window.trendsChart = new Chart(trendsChartCtx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'Applied',
                            data: appCounts,
                            borderColor: '#00f0ff', // accent-primary
                            backgroundColor: appliedGradient,
                            borderWidth: 2,
                            tension: 0.4,
                            fill: true,
                            pointBackgroundColor: '#00f0ff',
                            pointBorderColor: '#000000',
                            pointRadius: 4,
                            pointHoverRadius: 6,
                            pointBorderWidth: 1,
                            pointHoverBorderWidth: 2,
                            pointHoverBackgroundColor: '#ffffff',
                            pointHoverBorderColor: '#00f0ff'
                        },
                        {
                            label: 'Responses',
                            data: responseCounts,
                            borderColor: '#9d00ff', // accent-secondary
                            backgroundColor: responsesGradient,
                            borderWidth: 2,
                            tension: 0.4,
                            fill: true,
                            pointBackgroundColor: '#9d00ff',
                            pointBorderColor: '#000000',
                            pointRadius: 4,
                            pointHoverRadius: 6,
                            pointBorderWidth: 1,
                            pointHoverBorderWidth: 2,
                            pointHoverBackgroundColor: '#ffffff',
                            pointHoverBorderColor: '#9d00ff'
                        },
                        {
                            label: 'Interviews',
                            data: interviewCounts,
                            borderColor: '#05ffa1', // accent-quaternary
                            backgroundColor: interviewsGradient,
                            borderWidth: 2,
                            tension: 0.4,
                            fill: true,
                            pointBackgroundColor: '#05ffa1',
                            pointBorderColor: '#000000',
                            pointRadius: 4,
                            pointHoverRadius: 6,
                            pointBorderWidth: 1,
                            pointHoverBorderWidth: 2,
                            pointHoverBackgroundColor: '#ffffff',
                            pointHoverBorderColor: '#05ffa1'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1,
                                color: "#00f0ff",
                                font: {
                                    family: "'Space Mono', monospace",
                                    size: 10
                                }
                            },
                            grid: {
                                color: 'rgba(0, 240, 255, 0.1)',
                                lineWidth: 0.5,
                                tickBorderDash: [2, 2]
                            },
                            border: {
                                dash: [4, 4],
                                color: 'rgba(0, 240, 255, 0.2)'
                            }
                        },
                        x: {
                            ticks: {
                                color: "#00f0ff",
                                maxRotation: 45,
                                minRotation: 45,
                                font: {
                                    family: "'Space Mono', monospace",
                                    size: 10
                                }
                            },
                            grid: {
                                color: 'rgba(0, 240, 255, 0.1)',
                                lineWidth: 0.5
                            },
                            border: {
                                dash: [4, 4],
                                color: 'rgba(0, 240, 255, 0.2)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: "#00f0ff",
                                font: {
                                    family: "'Space Mono', monospace",
                                    size: 12
                                },
                                boxWidth: 15,
                                padding: 15
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: '#ffffff',
                            bodyColor: '#ffffff',
                            borderColor: '#00f0ff',
                            borderWidth: 1,
                            bodyFont: {
                                family: "'Space Mono', monospace"
                            },
                            titleFont: {
                                family: "'Space Mono', monospace",
                                weight: 'bold'
                            },
                            callbacks: {
                                afterLabel: function(context) {
                                    const datasetIndex = context.datasetIndex;
                                    const index = context.dataIndex;
                                    
                                    if (datasetIndex === 0) {
                                        const responseRate = appCounts[index] > 0 ? (responseCounts[index] / appCounts[index] * 100).toFixed(1) : 0;
                                        return `Response rate: ${responseRate}%`;
                                    }
                                    return '';
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Get dates for the last 8 weeks
        function getLast8Weeks() {
            const dates = [];
            const today = new Date();
            
            for (let i = 7; i >= 0; i--) {
                const date = new Date();
                date.setDate(today.getDate() - (i * 7));
                // Set to beginning of week (Sunday)
                date.setDate(date.getDate() - date.getDay());
                dates.push(new Date(date));
            }
            
            return dates;
        }
        
        // Count interviews by week
        function countInterviewsByWeek(apps, weeks) {
            return weeks.map(weekStart => {
                const weekEnd = new Date(weekStart);
                weekEnd.setDate(weekStart.getDate() + 6);
                
                return apps.filter(app => {
                    if (!app.history) return false;
                    
                    const interviewEntry = app.history.find(h => 
                        h.status === 'Interview Scheduled' && 
                        new Date(h.date) >= weekStart && 
                        new Date(h.date) <= weekEnd
                    );
                    
                    return !!interviewEntry;
                }).length;
            });
        }
        
        // Calculate success rates by day of week
        function calculateDaySuccessRates(apps) {
            const dayCount = {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0}; // Sun-Sat
            const daySuccess = {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0}; // Sun-Sat
            
            apps.forEach(app => {
                const appDate = new Date(app.date);
                const dayOfWeek = appDate.getDay();
                dayCount[dayOfWeek]++;
                
                // Consider success as getting an interview or offer
                if (app.status === 'Interview Scheduled' || app.status === 'Offer Received') {
                    daySuccess[dayOfWeek]++;
                }
            });
            
            // Calculate success rate
            const successRates = {};
            for (let day in dayCount) {
                successRates[day] = dayCount[day] > 0 ? daySuccess[day] / dayCount[day] : 0;
            }
            
            return successRates;
        }
        
        // Analyze job board success rates
        function analyzeJobBoardSuccessRates(apps) {
            const jobBoardPatterns = [
                { pattern: /linkedin\.com/i, source: 'LinkedIn' },
                { pattern: /indeed\.com/i, source: 'Indeed' },
                { pattern: /glassdoor\.com/i, source: 'Glassdoor' },
                { pattern: /monster\.com/i, source: 'Monster' },
                { pattern: /ziprecruiter\.com/i, source: 'ZipRecruiter' },
                { pattern: /careerbuilder\.com/i, source: 'CareerBuilder' },
                { pattern: /weworkremotely\.com/i, source: 'We Work Remotely' },
                { pattern: /remoteok\.com/i, source: 'Remote OK' },
                { pattern: /flexjobs\.com/i, source: 'FlexJobs' },
                { pattern: /workingnomads\.com/i, source: 'Working Nomads' },
                { pattern: /simplyhired\.com/i, source: 'SimplyHired' }
            ];
            
            const sources = {};
            
            // Count applications and responses by source
            apps.forEach(app => {
                if (!app.url) return;
                
                let source = 'Other';
                
                // Identify source from URL
                for (const board of jobBoardPatterns) {
                    if (board.pattern.test(app.url)) {
                        source = board.source;
                        break;
                    }
                }
                
                if (!sources[source]) {
                    sources[source] = {
                        count: 0,
                        responses: 0,
                        interviews: 0
                    };
                }
                
                sources[source].count++;
                
                // Count as response if not applied
                if (app.status !== 'Applied') {
                    sources[source].responses++;
                }
                
                // Count as interview if interview scheduled or offer
                if (app.status === 'Interview Scheduled' || app.status === 'Offer Received') {
                    sources[source].interviews++;
                }
            });
            
            // Calculate rates and sort by response rate
            return Object.entries(sources)
                .map(([source, stats]) => ({
                    source,
                    count: stats.count,
                    responseRate: stats.count > 0 ? stats.responses / stats.count : 0,
                    interviewRate: stats.count > 0 ? stats.interviews / stats.count : 0
                }))
                .filter(data => data.count >= 2) // Only include sources with at least 2 applications
                .sort((a, b) => b.responseRate - a.responseRate);
        }
        
        // Get dates for the last 12 weeks
        function getLast12Weeks() {
            const dates = [];
            const today = new Date();
            
            for (let i = 11; i >= 0; i--) {
                const date = new Date();
                date.setDate(today.getDate() - (i * 7));
                // Set to beginning of week (Sunday)
                date.setDate(date.getDate() - date.getDay());
                dates.push(new Date(date));
            }
            
            return dates;
        }
        
        // Count applications by week
        function countApplicationsByWeek(apps, weeks) {
            return weeks.map(weekStart => {
                const weekEnd = new Date(weekStart);
                weekEnd.setDate(weekStart.getDate() + 6);
                
                return apps.filter(app => {
                    const appDate = new Date(app.date);
                    return appDate >= weekStart && appDate <= weekEnd;
                }).length;
            });
        }
        
        // Count responses by week
        function countResponsesByWeek(apps, weeks) {
            return weeks.map(weekStart => {
                const weekEnd = new Date(weekStart);
                weekEnd.setDate(weekStart.getDate() + 6);
                
                return apps.filter(app => {
                    if (!app.history || app.history.length < 2) return false;
                    
                    const responseEntry = app.history.find(h => 
                        h.status !== 'Applied' && 
                        new Date(h.date) >= weekStart && 
                        new Date(h.date) <= weekEnd
                    );
                    
                    return !!responseEntry;
                }).length;
            });
        }
        
        // Count applications by day of week
        function countApplicationsByDayOfWeek(apps) {
            const dayCount = {0: 0, 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0}; // Sun-Sat
            
            apps.forEach(app => {
                const appDate = new Date(app.date);
                const dayOfWeek = appDate.getDay();
                dayCount[dayOfWeek]++;
            });
            
            return dayCount;
        }
        
        // Helper to get key with highest value in object
        function getKeyWithHighestValue(obj) {
            return Object.keys(obj).reduce((a, b) => obj[a] > obj[b] ? a : b);
        }
        
        // Convert day number to name
        function getDayName(dayNumber) {
            const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            return days[dayNumber];
        }

        // Render Remote Job Insights
        function renderRemoteJobInsights(apps) {
            // Identify remote applications based on URL or job title
            const remoteApps = apps.filter(app => 
                (app.url && /remote|weworkremotely|remoteok|flexjobs|workingnomads/i.test(app.url)) ||
                (app.title && /remote|wfh|work from home/i.test(app.title))
            );
            
            const onSiteApps = apps.filter(app => !remoteApps.includes(app));
            
            // Calculate stats for remote applications
            const remoteCount = remoteApps.length;
            const remoteResponseCount = remoteApps.filter(app => app.status !== 'Applied').length;
            const remoteInterviewCount = remoteApps.filter(app => 
                app.status === 'Interview Scheduled' || app.status === 'Offer Received'
            ).length;
            
            const remoteResponseRate = remoteCount > 0 ? (remoteResponseCount / remoteCount) * 100 : 0;
            const remoteInterviewRate = remoteCount > 0 ? (remoteInterviewCount / remoteCount) * 100 : 0;
            
            // Calculate stats for on-site applications
            const onSiteCount = onSiteApps.length;
            const onSiteResponseCount = onSiteApps.filter(app => app.status !== 'Applied').length;
            const onSiteInterviewCount = onSiteApps.filter(app => 
                app.status === 'Interview Scheduled' || app.status === 'Offer Received'
            ).length;
            
            const onSiteResponseRate = onSiteCount > 0 ? (onSiteResponseCount / onSiteCount) * 100 : 0;
            const onSiteInterviewRate = onSiteCount > 0 ? (onSiteInterviewCount / onSiteCount) * 100 : 0;
            
            // Update metrics
            document.getElementById('remote-application-count').textContent = remoteCount;
            document.getElementById('remote-response-rate').textContent = `${remoteResponseRate.toFixed(0)}%`;
            document.getElementById('remote-interview-rate').textContent = `${remoteInterviewRate.toFixed(0)}%`;
            
            // Analyze remote job boards
            const remotePlatforms = analyzeRemotePlatforms(remoteApps);
            
            // Update top remote platforms list
            const remotePlatformsEl = document.getElementById('top-remote-platforms');
            if (remotePlatformsEl) {
                remotePlatformsEl.innerHTML = remotePlatforms.length > 0
                    ? remotePlatforms.slice(0, 3).map(platform => 
                        `<li>${platform.source} <span class="response-rate">${Math.round(platform.responseRate * 100)}%</span></li>`
                    ).join('')
                    : '<li>No remote platforms data</li>';
            }
            
            // Create remote vs. on-site comparison chart
            const remoteChartCtx = document.getElementById('remote-vs-onsite-chart').getContext('2d');
            if (window.remoteComparisonChart) window.remoteComparisonChart.destroy();
            
            window.remoteComparisonChart = new Chart(remoteChartCtx, {
                type: 'bar',
                data: {
                    labels: ['Applications', 'Response Rate', 'Interview Rate'],
                    datasets: [
                        {
                            label: 'Remote',
                            data: [remoteCount, remoteResponseRate, remoteInterviewRate],
                            backgroundColor: 'rgba(0, 240, 255, 0.7)',
                            borderColor: 'rgba(0, 240, 255, 1)',
                            borderWidth: 1,
                            borderRadius: 4
                        },
                        {
                            label: 'On-site',
                            data: [onSiteCount, onSiteResponseRate, onSiteInterviewRate],
                            backgroundColor: 'rgba(157, 0, 255, 0.7)',
                            borderColor: 'rgba(157, 0, 255, 1)',
                            borderWidth: 1,
                            borderRadius: 4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value, index, values) {
                                    return index === 0 ? value : value + '%';
                                },
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary')
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.05)'
                            }
                        },
                        x: {
                            ticks: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary')
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.05)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-primary')
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const datasetLabel = context.dataset.label;
                                    const value = context.raw;
                                    const index = context.dataIndex;
                                    
                                    if (index === 0) {
                                        return `${datasetLabel}: ${value} applications`;
                                    } else {
                                        return `${datasetLabel}: ${value.toFixed(1)}%`;
                                    }
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Analyze remote platforms success rates
        function analyzeRemotePlatforms(apps) {
            const platformPatterns = [
                { pattern: /weworkremotely\.com/i, source: 'We Work Remotely' },
                { pattern: /remoteok\.com/i, source: 'Remote OK' },
                { pattern: /flexjobs\.com/i, source: 'FlexJobs' },
                { pattern: /workingnomads\.com/i, source: 'Working Nomads' },
                { pattern: /linkedin\.com.*remote/i, source: 'LinkedIn Remote' },
                { pattern: /indeed\.com.*remote/i, source: 'Indeed Remote' },
                { pattern: /remote\.co/i, source: 'Remote.co' },
                { pattern: /remote\.io/i, source: 'Remote.io' },
                { pattern: /justremote\.co/i, source: 'JustRemote' },
                { pattern: /remotive\.io/i, source: 'Remotive' }
            ];
            
            const platforms = {};
            
            // Count applications and responses by platform
            apps.forEach(app => {
                if (!app.url) return;
                
                let source = 'Other Remote';
                
                // Identify source from URL
                for (const platform of platformPatterns) {
                    if (platform.pattern.test(app.url)) {
                        source = platform.source;
                        break;
                    }
                }
                
                if (!platforms[source]) {
                    platforms[source] = {
                        count: 0,
                        responses: 0,
                        interviews: 0
                    };
                }
                
                platforms[source].count++;
                
                // Count as response if not applied
                if (app.status !== 'Applied') {
                    platforms[source].responses++;
                }
                
                // Count as interview if interview scheduled or offer
                if (app.status === 'Interview Scheduled' || app.status === 'Offer Received') {
                    platforms[source].interviews++;
                }
            });
            
            // Calculate rates and sort by response rate
            return Object.entries(platforms)
                .map(([source, stats]) => ({
                    source,
                    count: stats.count,
                    responseRate: stats.count > 0 ? stats.responses / stats.count : 0,
                    interviewRate: stats.count > 0 ? stats.interviews / stats.count : 0
                }))
                .filter(data => data.count > 0) // Only include sources with at least 1 application
                .sort((a, b) => b.responseRate - a.responseRate);
        }
        
        // Render Salary Insights
        function renderSalaryInsights(apps) {
            // Get expected salary data
            const expectedSalaries = apps
                .filter(app => app.salary && app.salary.expected > 0)
                .map(app => ({
                    amount: app.salary.expected,
                    title: app.title,
                    company: app.company,
                    isRemote: isRemoteJob(app)
                }));
            
            // Get offered salary data
            const offeredSalaries = apps
                .filter(app => app.salary && app.salary.offered !== null)
                .map(app => ({
                    amount: app.salary.offered,
                    title: app.title,
                    company: app.company,
                    isRemote: isRemoteJob(app)
                }));
                
            // Calculate average expected salary
            const avgExpected = expectedSalaries.length > 0 
                ? Math.round(expectedSalaries.reduce((sum, s) => sum + s.amount, 0) / expectedSalaries.length) 
                : 0;
                
            // Calculate average offered salary
            const avgOffered = offeredSalaries.length > 0 
                ? Math.round(offeredSalaries.reduce((sum, s) => sum + s.amount, 0) / offeredSalaries.length) 
                : 0;
            
            // Calculate offer vs expected ratio
            const offerExpectedRatio = (avgExpected > 0 && avgOffered > 0) 
                ? Math.round((avgOffered / avgExpected) * 100 - 100) 
                : 0;
                
            // Update salary cards
            document.getElementById('avg-expected').textContent = formatCurrency(avgExpected);
            document.getElementById('avg-offered').textContent = formatCurrency(avgOffered);
            document.getElementById('offer-expected-ratio').textContent = (offerExpectedRatio >= 0 ? '+' : '') + offerExpectedRatio + '%';
            
            // Calculate remote vs on-site salary difference
            let remoteSalaryDiff = 0;
            let remoteSalaryDirection = 'equal to';
            
            if (expectedSalaries.length > 0) {
                const remoteSalaries = expectedSalaries.filter(s => s.isRemote);
                const onSiteSalaries = expectedSalaries.filter(s => !s.isRemote);
                
                if (remoteSalaries.length > 0 && onSiteSalaries.length > 0) {
                    const avgRemote = remoteSalaries.reduce((sum, s) => sum + s.amount, 0) / remoteSalaries.length;
                    const avgOnSite = onSiteSalaries.reduce((sum, s) => sum + s.amount, 0) / onSiteSalaries.length;
                    
                    if (avgRemote !== avgOnSite) {
                        remoteSalaryDiff = Math.abs(Math.round((avgRemote / avgOnSite - 1) * 100));
                        remoteSalaryDirection = avgRemote < avgOnSite ? 'lower' : 'higher';
                    }
                }
            }
            
            document.getElementById('remote-salary-diff').textContent = remoteSalaryDiff + '%';
            document.getElementById('remote-salary-direction').textContent = remoteSalaryDirection;
            
            // Analyze salary by job title
            const titleSalaryData = analyzeJobTitleSalaries(apps);
            
            if (titleSalaryData.length > 0) {
                const highestTitle = titleSalaryData[0];
                document.getElementById('highest-paying-title').textContent = highestTitle.title;
                document.getElementById('highest-title-salary').textContent = formatCurrency(highestTitle.avgSalary);
            }
            
            // Create salary comparison chart (expected vs offered)
            const salaryChartCtx = document.getElementById('salary-comparison-chart').getContext('2d');
            if (window.salaryComparisonChart) window.salaryComparisonChart.destroy();
            
            const salaryComparisonData = apps
                .filter(app => app.salary && app.salary.expected > 0)
                .map(app => ({
                    title: `${app.company} - ${app.title}`,
                    expected: app.salary.expected,
                    offered: app.salary.offered || 0
                }))
                .slice(0, 7); // Limit to 7 most recent applications
            
            window.salaryComparisonChart = new Chart(salaryChartCtx, {
                type: 'bar',
                data: {
                    labels: salaryComparisonData.map(d => d.title),
                    datasets: [
                        {
                            label: 'Expected',
                            data: salaryComparisonData.map(d => d.expected),
                            backgroundColor: 'rgba(0, 240, 255, 0.7)',
                            borderColor: 'rgba(0, 240, 255, 1)',
                            borderWidth: 1,
                            borderRadius: 4
                        },
                        {
                            label: 'Offered',
                            data: salaryComparisonData.map(d => d.offered),
                            backgroundColor: 'rgba(157, 0, 255, 0.7)',
                            borderColor: 'rgba(157, 0, 255, 1)',
                            borderWidth: 1,
                            borderRadius: 4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return formatK(value);
                                },
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary')
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.05)'
                            },
                            title: {
                                display: true,
                                text: 'Salary',
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary')
                            }
                        },
                        x: {
                            ticks: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary')
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.05)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-primary')
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.dataset.label;
                                    const value = context.raw;
                                    return `${label}: ${formatCurrency(value)}`;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Check if a job is remote
        function isRemoteJob(app) {
            return (app.url && /remote|weworkremotely|remoteok|flexjobs|workingnomads/i.test(app.url)) ||
                   (app.title && /remote|wfh|work from home/i.test(app.title));
        }
        
        // Analyze salary by job title
        function analyzeJobTitleSalaries(apps) {
            // Common job title patterns
            const titlePatterns = [
                { pattern: /software engineer|developer|programmer|coder/i, title: 'Software Engineer' },
                { pattern: /frontend|front end|front-end/i, title: 'Frontend Developer' },
                { pattern: /backend|back end|back-end/i, title: 'Backend Developer' },
                { pattern: /fullstack|full stack|full-stack/i, title: 'Full Stack Developer' },
                { pattern: /data (?:scientist|analyst|engineer)/i, title: 'Data Scientist/Analyst' },
                { pattern: /(?:ui|ux|product) designer/i, title: 'UX/UI Designer' },
                { pattern: /devops|sre|site reliability/i, title: 'DevOps/SRE' },
                { pattern: /qa|quality assurance|test/i, title: 'QA Engineer' },
                { pattern: /product manager/i, title: 'Product Manager' },
                { pattern: /project manager/i, title: 'Project Manager' },
                { pattern: /mobile|ios|android/i, title: 'Mobile Developer' },
                { pattern: /ml|machine learning|ai/i, title: 'ML Engineer' }
            ];
            
            // Group applications by normalized title
            const titleGroups = {};
            
            apps.forEach(app => {
                if (!app.title || !app.salary) return;
                
                // Normalize the title
                let normalizedTitle = 'Other';
                
                for (const pattern of titlePatterns) {
                    if (pattern.pattern.test(app.title)) {
                        normalizedTitle = pattern.title;
                        break;
                    }
                }
                
                if (!titleGroups[normalizedTitle]) {
                    titleGroups[normalizedTitle] = {
                        title: normalizedTitle,
                        count: 0,
                        expectedSum: 0,
                        offeredSum: 0,
                        offeredCount: 0
                    };
                }
                
                titleGroups[normalizedTitle].count++;
                
                if (app.salary.expected > 0) {
                    titleGroups[normalizedTitle].expectedSum += app.salary.expected;
                }
                
                if (app.salary.offered !== null) {
                    titleGroups[normalizedTitle].offeredSum += app.salary.offered;
                    titleGroups[normalizedTitle].offeredCount++;
                }
            });
            
            // Calculate averages and create result
            return Object.values(titleGroups)
                .map(group => {
                    const avgExpected = group.count > 0 ? Math.round(group.expectedSum / group.count) : 0;
                    const avgOffered = group.offeredCount > 0 ? Math.round(group.offeredSum / group.offeredCount) : 0;
                    
                    return {
                        title: group.title,
                        count: group.count,
                        avgSalary: avgOffered > 0 ? avgOffered : avgExpected // Use offered if available, otherwise expected
                    };
                })
                .filter(data => data.avgSalary > 0 && data.count >= 1)
                .sort((a, b) => b.avgSalary - a.avgSalary);
        }
        
        // Create salary brackets for distribution chart
        function createSalaryBrackets(salaries) {
            if (salaries.length === 0) {
                return {
                    labels: ['$0-$50K', '$50K-$100K', '$100K-$150K', '$150K-$200K', '$200K+'],
                    counts: [0, 0, 0, 0, 0]
                };
            }
            
            const min = Math.min(...salaries);
            const max = Math.max(...salaries);
            
            // Create brackets based on min and max
            const bracketSize = Math.max(25000, Math.ceil((max - min) / 5 / 10000) * 10000);
            const brackets = [];
            const counts = [];
            
            let currentBracket = Math.floor(min / bracketSize) * bracketSize;
            for (let i = 0; i < 5; i++) {
                const bracketMin = currentBracket;
                const bracketMax = currentBracket + bracketSize;
                
                brackets.push(`$${formatK(bracketMin)}-$${formatK(bracketMax)}`);
                counts.push(salaries.filter(s => s >= bracketMin && s < bracketMax).length);
                
                currentBracket = bracketMax;
            }
            
            // Add last bracket for anything higher
            brackets[brackets.length - 1] = `$${formatK(currentBracket - bracketSize)}+`;
            
            return {
                labels: brackets,
                counts: counts
            };
        }
        
        // Format number as K
        function formatK(num) {
            return Math.round(num / 1000) + 'K';
        }
        
        // Create gradient color for chart
        function createGradientColor(ctx) {
            const gradient = ctx.createLinearGradient(0, 0, 0, 400);
            gradient.addColorStop(0, 'rgba(0, 240, 255, 0.8)');
            gradient.addColorStop(1, 'rgba(157, 0, 255, 0.2)');
            return gradient;
        }

        // Render Skills Analysis - Placeholder for now since no real skill data exists in the app
        function renderSkillsAnalysis(apps) {
            // Placeholder data for skills analysis
            const skillsData = [
                { text: 'JavaScript', value: 30 },
                { text: 'React', value: 28 },
                { text: 'TypeScript', value: 25 },
                { text: 'Node.js', value: 20 },
                { text: 'Python', value: 18 },
                { text: 'SQL', value: 16 },
                { text: 'HTML/CSS', value: 15 },
                { text: 'Docker', value: 12 },
                { text: 'AWS', value: 10 },
                { text: 'GraphQL', value: 8 },
                { text: 'Git', value: 8 },
                { text: 'MongoDB', value: 7 },
                { text: 'Vue.js', value: 6 },
                { text: 'CI/CD', value: 5 },
                { text: 'Agile', value: 5 }
            ];
            
            // In a real implementation, we would extract skills from job titles, descriptions, and notes
            // Create word cloud (mock implementation)
            document.getElementById('skills-cloud').innerHTML = `
                <div style="display: flex; flex-wrap: wrap; justify-content: center; align-items: center; height: 100%;">
                    ${skillsData.map(skill => `
                        <div style="
                            margin: 8px; 
                            padding: 8px 16px; 
                            background: rgba(0, 240, 255, ${0.1 + (skill.value / 100)}); 
                            border-radius: 20px; 
                            font-size: ${12 + (skill.value / 3)}px;
                            transition: all 0.3s ease;
                        " class="hover-lift">
                            ${skill.text}
                        </div>
                    `).join('')}
                </div>
            `;
            
            // Placeholder data for insights
            document.getElementById('top-skills').textContent = 'ReactJS, TypeScript';
            document.getElementById('skills-conversion').textContent = '43%';
            document.getElementById('skill-gaps').textContent = 'Docker, Kubernetes';
        }

        // Render Company Intelligence
        function renderCompanyIntelligence(apps) {
            // Group applications by company
            const companiesByResponse = apps.reduce((acc, app) => {
                if (!acc[app.company]) {
                    acc[app.company] = {
                        name: app.company,
                        applications: [],
                        responses: 0,
                        avgResponseTime: 0
                    };
                }
                
                acc[app.company].applications.push(app);
                
                // Check if there was a response (status change from Applied)
                if (app.history && app.history.length > 1) {
                    const appliedEntry = app.history.find(h => h.status === 'Applied');
                    const responseEntry = app.history.find(h => 
                        h.status !== 'Applied' && 
                        new Date(h.date) > new Date(appliedEntry.date)
                    );
                    
                    if (appliedEntry && responseEntry) {
                        acc[app.company].responses++;
                        
                        // Calculate response time in days
                        const appliedDate = new Date(appliedEntry.date);
                        const responseDate = new Date(responseEntry.date);
                        const diffTime = Math.abs(responseDate - appliedDate);
                        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                        
                        acc[app.company].responseTimes = acc[app.company].responseTimes || [];
                        acc[app.company].responseTimes.push(diffDays);
                    }
                }
                
                return acc;
            }, {});
            
            // Calculate average response time for each company
            Object.values(companiesByResponse).forEach(company => {
                company.responseRate = company.applications.length > 0 
                    ? company.responses / company.applications.length 
                    : 0;
                    
                company.avgResponseTime = company.responseTimes && company.responseTimes.length > 0
                    ? company.responseTimes.reduce((sum, time) => sum + time, 0) / company.responseTimes.length
                    : null;
            });
            
            // Sort companies by response rate
            const topResponsiveCompanies = Object.values(companiesByResponse)
                .filter(c => c.avgResponseTime !== null)
                .sort((a, b) => a.avgResponseTime - b.avgResponseTime)
                .slice(0, 5);
                
            // Update responsive companies list
            const responsiveCompaniesEl = document.getElementById('responsive-companies');
            if (responsiveCompaniesEl) {
                responsiveCompaniesEl.innerHTML = topResponsiveCompanies.length > 0
                    ? topResponsiveCompanies.map(company => 
                        `<li>${company.name} <span class="response-time">${company.avgResponseTime.toFixed(1)} days</span></li>`
                    ).join('')
                    : '<li>No data available</li>';
            }
            
            // Group applications by location - using fake data for now since we don't have location data
            const locationData = {
                'San Francisco': { count: 3, avgSalary: 145000 },
                'New York': { count: 2, avgSalary: 138000 },
                'Seattle': { count: 2, avgSalary: 135000 },
                'Austin': { count: 1, avgSalary: 120000 },
                'Remote': { count: 4, avgSalary: 115000 }
            };
            
            // Sort locations by average salary
            const topLocations = Object.entries(locationData)
                .sort((a, b) => b[1].avgSalary - a[1].avgSalary)
                .slice(0, 5);
                
            // Update best locations list
            const bestLocationsEl = document.getElementById('best-locations');
            if (bestLocationsEl) {
                bestLocationsEl.innerHTML = topLocations.map(([location, data]) => 
                    `<li>${location} <span class="salary-indicator">${formatCurrency(data.avgSalary)}</span></li>`
                ).join('');
            }
            
            // Create company response chart
            const companyChartCtx = document.getElementById('company-response-chart').getContext('2d');
            if (window.companyResponseChart) window.companyResponseChart.destroy();
            
            // Prepare data for chart
            const companyChartData = Object.values(companiesByResponse)
                .filter(c => c.applications.length >= 1)
                .sort((a, b) => b.responseRate - a.responseRate)
                .slice(0, 5);
                
            window.companyResponseChart = new Chart(companyChartCtx, {
                type: 'bar',
                data: {
                    labels: companyChartData.map(c => c.name),
                    datasets: [{
                        label: 'Response Rate',
                        data: companyChartData.map(c => Math.round(c.responseRate * 100)),
                        backgroundColor: 'rgba(255, 152, 0, 0.7)',
                        borderColor: 'rgba(255, 152, 0, 1)',
                        borderWidth: 1,
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `Response rate: ${context.raw}%`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                },
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary')
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.05)'
                            }
                        },
                        x: {
                            ticks: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary')
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.05)'
                            }
                        }
                    }
                }
            });
        }

        // Render Market Health
        function renderMarketHealth(apps) {
            // Using fake market health data for demonstration
            const marketScore = 72;
            const marketTrend = 3.2;
            
            // Update market health indicators
            document.getElementById('market-score').textContent = marketScore;
            document.getElementById('market-indicator').textContent = marketScore > 50 ? '🟢' : '🔴';
            
            const marketTrendEl = document.getElementById('market-trend-indicator');
            if (marketTrendEl) {
                if (marketTrend > 0) {
                    marketTrendEl.classList.add('trend-up');
                    marketTrendEl.classList.remove('trend-down');
                } else {
                    marketTrendEl.classList.add('trend-down');
                    marketTrendEl.classList.remove('trend-up');
                }
                
                document.getElementById('market-trend-value').textContent = 
                    (marketTrend > 0 ? '+' : '') + marketTrend.toFixed(1) + '%';
            }
            
            // Insights placeholders
            document.getElementById('best-hiring-month').textContent = 'January';
            document.getElementById('market-forecast').textContent = '5% increase';
            
            // Create market health chart - showing a fake seasonal pattern
            const healthChartCtx = document.getElementById('market-health-chart').getContext('2d');
            if (window.marketHealthChart) window.marketHealthChart.destroy();
            
            // Fake market health data - 12 months
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
            const marketData = [78, 75, 70, 68, 65, 62, 60, 65, 70, 73, 68, 72]; // Current year
            const prevYearData = [74, 70, 65, 63, 60, 58, 56, 60, 65, 68, 65, 70]; // Previous year
            
            window.marketHealthChart = new Chart(healthChartCtx, {
                type: 'line',
                data: {
                    labels: months,
                    datasets: [
                        {
                            label: 'This Year',
                            data: marketData,
                            borderColor: 'rgba(0, 240, 255, 1)',
                            backgroundColor: 'rgba(0, 240, 255, 0.1)',
                            borderWidth: 2,
                            tension: 0.4,
                            fill: true
                        },
                        {
                            label: 'Previous Year',
                            data: prevYearData,
                            borderColor: 'rgba(157, 0, 255, 0.6)',
                            backgroundColor: 'rgba(157, 0, 255, 0.05)',
                            borderWidth: 2,
                            tension: 0.4,
                            fill: true,
                            borderDash: [5, 5]
                        }
                    ]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            title: {
                                display: true,
                                text: 'Market Health Score',
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary')
                            },
                            ticks: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary')
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.05)'
                            }
                        },
                        x: {
                            ticks: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary')
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.05)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-primary')
                            }
                        }
                    }
                }
            });
        }
        
        // Render Application Source Analysis
        function renderApplicationSourceAnalysis(apps) {
            // Count automatically vs manually tracked applications
            const autoTrackedApps = apps.filter(app => 
                app.history && 
                app.history.some(h => h.notes && h.notes.includes('Auto-tracked application'))
            );
            const manuallyTrackedApps = apps.filter(app => !autoTrackedApps.includes(app));
            
            const autoCount = autoTrackedApps.length;
            const manualCount = manuallyTrackedApps.length;
            const totalCount = apps.length;
            
            const autoPercent = totalCount > 0 ? Math.round((autoCount / totalCount) * 100) : 0;
            const manualPercent = totalCount > 0 ? Math.round((manualCount / totalCount) * 100) : 0;
            
            // Update source analysis
            document.getElementById('auto-track-count').textContent = autoCount;
            document.getElementById('auto-track-percent').textContent = `${autoPercent}%`;
            document.getElementById('manual-track-count').textContent = manualCount;
            document.getElementById('manual-track-percent').textContent = `${manualPercent}%`;
            
            // Analyze top performing sources
            const jobBoardStats = analyzeJobBoardSuccessRates(apps);
            
            // Update top sources list
            const topSourcesEl = document.getElementById('top-sources');
            if (topSourcesEl) {
                topSourcesEl.innerHTML = jobBoardStats.length > 0
                    ? jobBoardStats.slice(0, 3).map(source => 
                        `<li>${source.source} <span class="response-time">${Math.round(source.responseRate * 100)}% response</span></li>`
                    ).join('')
                    : '<li>No source data available</li>';
            }
            
            // Create source comparison chart
            const sourceChartCtx = document.getElementById('source-comparison-chart').getContext('2d');
            if (window.sourceComparisonChart) window.sourceComparisonChart.destroy();
            
            // Prepare data for chart - top 5 sources by application count
            const topSources = jobBoardStats
                .sort((a, b) => b.count - a.count)
                .slice(0, 5);
            
            window.sourceComparisonChart = new Chart(sourceChartCtx, {
                type: 'bar',
                data: {
                    labels: topSources.map(s => s.source),
                    datasets: [
                        {
                            label: 'Response Rate',
                            data: topSources.map(s => Math.round(s.responseRate * 100)),
                            backgroundColor: 'rgba(0, 240, 255, 0.7)',
                            borderColor: 'rgba(0, 240, 255, 1)',
                            borderWidth: 1,
                            borderRadius: 4,
                            yAxisID: 'y'
                        },
                        {
                            label: 'Applications',
                            data: topSources.map(s => s.count),
                            backgroundColor: 'rgba(157, 0, 255, 0.7)',
                            borderColor: 'rgba(157, 0, 255, 1)',
                            borderWidth: 1,
                            borderRadius: 4,
                            yAxisID: 'y1'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            beginAtZero: true,
                            max: 100,
                            title: {
                                display: true,
                                text: 'Response Rate (%)',
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary')
                            },
                            ticks: {
                                callback: function(value) {
                                    return value + '%';
                                },
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary')
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.05)'
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Applications Count',
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary')
                            },
                            ticks: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary')
                            },
                            grid: {
                                drawOnChartArea: false
                            }
                        },
                        x: {
                            ticks: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary')
                            },
                            grid: {
                                color: 'rgba(255, 255, 255, 0.05)'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-primary')
                            }
                        }
                    }
                }
            });
            
            // Create tracking method chart
            const trackingMethodCtx = document.getElementById('tracking-method-chart').getContext('2d');
            if (window.trackingMethodChart) window.trackingMethodChart.destroy();
            
            window.trackingMethodChart = new Chart(trackingMethodCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Auto-tracked', 'Manually Added'],
                    datasets: [{
                        data: [autoCount, manualCount],
                        backgroundColor: ['rgba(0, 240, 255, 0.7)', 'rgba(157, 0, 255, 0.7)']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.label;
                                    const value = context.raw;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = Math.round((value / total) * 100);
                                    return `${label}: ${value} (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Render Actionable Recommendations
        function renderActionableRecommendations(apps) {
            // Find best performing job board
            const jobBoardStats = analyzeJobBoardSuccessRates(apps);
            let bestJobBoard = "the job board with best results";
            let bestJobBoardRate = 0;
            
            if (jobBoardStats.length > 0) {
                const topJobBoard = jobBoardStats[0];
                bestJobBoard = topJobBoard.source;
                bestJobBoardRate = Math.round(topJobBoard.responseRate * 100);
            }
            
            // Count applications needing follow-up
            const followupCount = apps.filter(app => 
                app.status === 'Applied' && daysSince(app.date) > 10
            ).length;
            
            // Check weekly goal progress
            const today = new Date();
            const startOfWeek = new Date(today);
            startOfWeek.setDate(today.getDate() - today.getDay()); // Go to start of week (Sunday)
            startOfWeek.setHours(0, 0, 0, 0);
            
            const appsThisWeek = apps.filter(app => {
                const appDate = new Date(app.date);
                return appDate >= startOfWeek && appDate <= today;
            }).length;
            
            const weeklyGoal = 10; // Target is 10 applications per week
            const remainingApps = Math.max(0, weeklyGoal - appsThisWeek);
            const goalStatus = appsThisWeek >= weeklyGoal ? 'meeting' : 'below';
            
            // Update recommendation content
            document.getElementById('rec-job-board').textContent = bestJobBoard;
            document.getElementById('rec-response-rate').textContent = `${bestJobBoardRate}%`;
            document.getElementById('followup-count').textContent = followupCount;
            document.getElementById('goal-status').textContent = goalStatus;
            document.getElementById('remaining-apps').textContent = remainingApps;
        }
        
        // Add event listener for analytics time range selector
        document.addEventListener('DOMContentLoaded', () => {
            const timeRangeSelector = document.getElementById('analytics-time-range');
            if (timeRangeSelector) {
                timeRangeSelector.addEventListener('change', () => {
                    renderAnalytics();
                });
            }
        });

        // Sort Table for Applications
        function sortTable(colIndex) {
            const table = document.getElementById('applications-table');
            const tbody = table.querySelector('tbody');
            const rows = Array.from(tbody.querySelectorAll('tr'));
            const sortDirection = table.getAttribute('data-sort-dir') === 'asc' ? 'desc' : 'asc';
            table.setAttribute('data-sort-dir', sortDirection);
            rows.sort((a, b) => {
                const aValue = a.cells[colIndex].textContent.trim();
                const bValue = b.cells[colIndex].textContent.trim();
                if (colIndex === 2) {
                    return sortDirection === 'asc' ? new Date(aValue) - new Date(bValue) : new Date(bValue) - new Date(aValue);
                } else if (colIndex === 4 || colIndex === 5) {
                    const aNum = parseFloat(aValue.replace(/[^0-9.-]+/g, "")) || (aValue === 'N/A' ? -Infinity : 0);
                    const bNum = parseFloat(bValue.replace(/[^0-9.-]+/g, "")) || (bValue === 'N/A' ? -Infinity : 0);
                    return sortDirection === 'asc' ? aNum - bNum : bNum - aNum;
                }
                return sortDirection === 'asc' ? aValue.localeCompare(bValue) : bValue.localeCompare(aValue);
            });
            rows.forEach(row => tbody.appendChild(row));
        }

        // Export Data to CSV
        function exportData() {
            let csv = 'Job Title,Company,Date,Status,Expected Salary,Offered Salary,Notes,URL,Favorite\n';
            applications.forEach(app => {
                csv += `"${app.title}","${app.company}","${app.date}","${app.status}","${app.salary.expected || ''}","${app.salary.offered || ''}","${app.notes}","${app.url || ''}","${app.favorite ? 'Yes' : 'No'}"\n`;
            });
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'job_applications.csv';
            a.click();
        }

        // Render Reminders
        function renderReminders() {
            const container = document.getElementById('reminders-list');
            container.innerHTML = '';
            const reminders = applications.filter(app => app.status === 'Applied' && daysSince(app.date) > 10);
            if (reminders.length === 0) {
                container.innerHTML = '<p style="color: var(--text-tertiary); text-align: center; padding: 1rem;">No follow-up reminders at this time.</p>';
                return;
            }
            reminders.forEach(app => {
                const li = document.createElement('li');
                li.className = 'reminder-item';
                li.innerHTML = `
                    <div><strong>${app.company}</strong> - ${app.title}<br><small>Applied ${daysSince(app.date)} days ago</small></div>
                    <button onclick="markFollowed(${app.id})" class="action-btn" title="Mark as followed up">Mark Followed Up</button>
                `;
                container.appendChild(li);
            });
        }

        // Render Timeline
        function renderTimeline(app = null, containerId = 'app-timeline') {
            const container = document.getElementById(containerId);
            container.innerHTML = '';
            if (app) {
                if (app.history && app.history.length) {
                    app.history.sort((a, b) => new Date(a.date) - new Date(b.date)).forEach(h => {
                        addTimelineItem(container, h.date, formatDate(h.date), `<strong>${h.status}</strong>: ${h.notes}`);
                    });
                } else {
                    container.innerHTML = '<p style="color: var(--text-tertiary); text-align: center; padding: 1rem;">No history available for this application.</p>';
                }
            } else {
                let allHistory = [];
                applications.forEach(app => {
                    if (app.history) {
                        app.history.forEach(h => allHistory.push({ ...h, company: app.company, title: app.title, appId: app.id }));
                    }
                });
                allHistory.sort((a, b) => new Date(b.date) - new Date(a.date)).slice(0, 10).forEach(h => {
                    addTimelineItem(container, h.date, `<strong>${h.company}</strong> - ${h.title}`, `<strong>${h.status}</strong>: ${h.notes}`);
                });
                if (allHistory.length === 0) {
                    container.innerHTML = '<p style="color: var(--text-tertiary); text-align: center; padding: 1rem;">No application history yet.</p>';
                }
            }
        }

        function addTimelineItem(container, date, title, content) {
            const item = document.createElement('div');
            item.className = 'timeline-item';
            item.innerHTML = `
                <div class="timeline-dot"></div>
                <div class="timeline-date">${formatDate(date)}</div>
                <div class="timeline-content">${title}<br>${content}</div>
            `;
            container.appendChild(item);
        }

        // Update Goal Progress
        function updateGoalProgress() {
            const today = new Date();
            const weekAgo = new Date(today);
            weekAgo.setDate(today.getDate() - 7);
            const weeklyApps = applications.filter(app => {
                const appDate = new Date(app.date);
                return appDate >= weekAgo && appDate <= today;
            });
            const weeklyCount = weeklyApps.length;
            const weeklyGoal = 10;
            const progress = Math.min(100, (weeklyCount / weeklyGoal) * 100);
            document.getElementById('weekly-goal-progress').style.width = `${progress}%`;
            document.getElementById('weekly-apps-submitted').textContent = `${weeklyCount} applications`;
            document.getElementById('weekly-goal-target').textContent = `Goal: ${weeklyGoal}/week`;
            renderApplicationChart();
        }

        // Render Application Chart
        function renderApplicationChart() {
            const today = new Date();
            const fourWeeksAgo = new Date(today);
            fourWeeksAgo.setDate(today.getDate() - 28);
            const dates = [];
            for (let i = 0; i < 28; i++) {
                const date = new Date(fourWeeksAgo);
                date.setDate(date.getDate() + i);
                dates.push(date.toISOString().split('T')[0]);
            }
            const appCounts = dates.reduce((acc, date) => { acc[date] = 0; return acc; }, {});
            applications.forEach(app => { if (app.date in appCounts) appCounts[app.date]++; });
            const chartData = {
                labels: dates.map(date => new Date(date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })),
                datasets: [{
                    label: 'Applications Submitted',
                    data: Object.values(appCounts),
                    backgroundColor: 'rgba(0, 240, 255, 0.2)',
                    borderColor: 'rgba(0, 240, 255, 1)',
                    borderWidth: 1,
                    tension: 0.4
                }]
            };
            const ctx = document.getElementById('application-chart').getContext('2d');
            if (window.applicationChart) window.applicationChart.destroy();
            window.applicationChart = new Chart(ctx, {
                type: 'line',
                data: chartData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { beginAtZero: true, ticks: { stepSize: 1, color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary') }, grid: { color: 'rgba(255, 255, 255, 0.05)' } },
                        x: { ticks: { color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary'), maxRotation: 45, minRotation: 45 }, grid: { color: 'rgba(255, 255, 255, 0.05)' } }
                    },
                    plugins: { legend: { labels: { color: getComputedStyle(document.documentElement).getPropertyValue('--text-primary') } } }
                }
            });
        }

        // GitHub Integration
        async function fetchGitHubData(token) {
            try {
                const userResponse = await fetch('https://api.github.com/user', {
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });
                if (!userResponse.ok) throw new Error('Failed to fetch user profile');
                const user = await userResponse.json();

                const reposResponse = await fetch('https://api.github.com/user/repos', {
                    headers: {
                        'Authorization': `Bearer ${token}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });
                if (!reposResponse.ok) throw new Error('Failed to fetch repositories');
                const repos = await reposResponse.json();

                githubData = { user, repos };
                renderProfilePage();
            } catch (error) {
                console.error('Error:', error);
                showNotification('Failed to fetch GitHub data. Check your token and try again.', 'error');
                logout();
            }
        }

        function handleLogin() {
            const token = document.getElementById('github-token-input').value;
            if (token) {
                localStorage.setItem('githubToken', token);
                document.getElementById('login-section').children[0].style.display = 'none';
                document.getElementById('login-section').children[1].style.display = 'none';
                document.getElementById('logout-btn').style.display = 'inline-block';
                fetchGitHubData(token);
                showNotification('Logged in with GitHub');
            } else {
                showNotification('Please enter a valid GitHub token.', 'error');
            }
        }

        function logout() {
            localStorage.removeItem('githubToken');
            githubData = null;
            document.getElementById('profile-page').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
            document.getElementById('login-section').children[0].style.display = 'inline-block';
            document.getElementById('login-section').children[1].style.display = 'inline-block';
            document.getElementById('logout-btn').style.display = 'none';
            showNotification('Logged out');
        }

        function renderProfilePage() {
            renderProfileInfo();
            renderProjectsView();
            renderProfileAnalytics();
        }

        function renderProfileInfo() {
            const container = document.getElementById('profile-info');
            const { user } = githubData;
            container.innerHTML = `
                <div style="display: flex; align-items: center; gap: 1rem;">
                    <img src="${user.avatar_url}" alt="Avatar" style="width: 100px; height: 100px; border-radius: 50%;">
                    <div>
                        <h3>${user.login}</h3>
                        <p>${user.bio || 'No bio available'}</p>
                        <a href="${user.html_url}" target="_blank">View GitHub Profile</a>
                    </div>
                </div>
                <div class="mt-4">
                    <h3>Cover Letter</h3>
                    <textarea id="cover-letter" rows="10" style="width: 100%;"></textarea>
                    <button class="btn-primary" onclick="generateCoverLetter()">Generate Cover Letter</button>
                </div>
                <div class="mt-4">
                    <h3>Resume</h3>
                    <textarea id="resume" rows="10" style="width: 100%;"></textarea>
                    <button class="btn-primary" onclick="generateResume()">Generate Resume</button>
                </div>
            `;
        }

        function generateCoverLetter() {
            document.getElementById('cover-letter').value = "Dear Hiring Manager,\n\nI am writing to express my interest in the [Position] role at [Company]. With my background in [Field], I believe I can contribute to your team.\n\n[More text]\n\nSincerely,\n[Your Name]";
        }

        function generateResume() {
            document.getElementById('resume').value = "[Your Name]\n[Contact Information]\n\nObjective:\n[Your objective]\n\nExperience:\n[Your experience]\n\nEducation:\n[Your education]\n\nSkills:\n[Your skills]";
        }

        function toggleProjectsView() {
            isProjectsKanbanView = document.getElementById('projects-view-toggle').checked;
            const tableView = document.getElementById('projects-table-view');
            const kanbanView = document.getElementById('projects-kanban-view');
            if (isProjectsKanbanView) {
                tableView.style.display = 'none';
                kanbanView.style.display = 'grid';
                renderProjectsKanban();
            } else {
                tableView.style.display = 'block';
                kanbanView.style.display = 'none';
                renderProjectsTable();
            }
        }

        function renderProjectsView() {
            if (isProjectsKanbanView) {
                renderProjectsKanban();
            } else {
                renderProjectsTable();
            }
        }

        function renderProjectsTable() {
            const tbody = document.querySelector('#projects-table tbody');
            tbody.innerHTML = '';
            let filteredRepos = filterProjects();

            filteredRepos.forEach(repo => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${repo.name}</td>
                    <td>${repo.description || 'N/A'}</td>
                    <td>${repo.language || 'N/A'}</td>
                    <td>${repo.stargazers_count}</td>
                    <td>${repo.forks_count}</td>
                    <td>${formatDate(repo.updated_at)}</td>
                    <td>
                        <button onclick="openProjectDetails('${repo.name}')" class="action-btn">Details</button>
                    </td>
                `;
                tbody.appendChild(row);
            });

            if (filteredRepos.length === 0) {
                tbody.innerHTML = `<tr><td colspan="7" style="text-align: center; padding: 2rem; color: var(--text-tertiary);">No projects found.</td></tr>`;
            }
        }

        function filterProjects() {
            let filteredRepos = [...githubData.repos];

            const nameFilter = document.getElementById('filter-project-name').value.toLowerCase();
            const descriptionFilter = document.getElementById('filter-project-description').value.toLowerCase();
            const languageFilter = document.getElementById('filter-project-language').value.toLowerCase();
            const starsFilter = parseInt(document.getElementById('filter-project-stars').value) || 0;
            const forksFilter = parseInt(document.getElementById('filter-project-forks').value) || 0;
            const updatedFilter = document.getElementById('filter-project-updated').value;

            return filteredRepos.filter(repo => {
                return (
                    repo.name.toLowerCase().includes(nameFilter) &&
                    (repo.description || '').toLowerCase().includes(descriptionFilter) &&
                    (repo.language || '').toLowerCase().includes(languageFilter) &&
                    repo.stargazers_count >= starsFilter &&
                    repo.forks_count >= forksFilter &&
                    (!updatedFilter || new Date(repo.updated_at) >= new Date(updatedFilter))
                );
            });
        }

        function sortProjectsTable(colIndex) {
            const table = document.getElementById('projects-table');
            const tbody = table.querySelector('tbody');
            const rows = Array.from(tbody.querySelectorAll('tr'));
            const sortDirection = table.getAttribute('data-sort-dir') === 'asc' ? 'desc' : 'asc';
            table.setAttribute('data-sort-dir', sortDirection);
            rows.sort((a, b) => {
                let aValue = a.cells[colIndex].textContent.trim();
                let bValue = b.cells[colIndex].textContent.trim();
                if (colIndex === 3 || colIndex === 4) {
                    aValue = parseInt(aValue) || 0;
                    bValue = parseInt(bValue) || 0;
                    return sortDirection === 'asc' ? aValue - bValue : bValue - aValue;
                } else if (colIndex === 5) {
                    aValue = new Date(aValue);
                    bValue = new Date(bValue);
                    return sortDirection === 'asc' ? aValue - bValue : bValue - aValue;
                } else {
                    return sortDirection === 'asc' ? aValue.localeCompare(bValue) : bValue.localeCompare(aValue);
                }
            });
            rows.forEach(row => tbody.appendChild(row));
        }

        function renderProjectsKanban() {
            const container = document.getElementById('projects-kanban-view');
            container.innerHTML = '';
            const kanban = document.createElement('div');
            kanban.className = 'kanban-container';
            kanban.style.display = 'grid';
            kanban.style.gridTemplateColumns = 'repeat(2, 1fr)';

            Object.keys(kanbanCategories).forEach(category => {
                const column = document.createElement('div');
                column.className = 'kanban-column';
                column.innerHTML = `<h3>${category}</h3>`;
                const cardsContainer = document.createElement('div');
                cardsContainer.className = 'kanban-cards';

                const reposInCategory = githubData.repos.filter(kanbanCategories[category]);
                reposInCategory.forEach(repo => {
                    const card = document.createElement('div');
                    card.className = 'kanban-card';
                    card.innerHTML = `
                        <div class="title">${repo.name}</div>
                        <div class="company">${repo.description || 'No description'}</div>
                        <button onclick="openProjectDetails('${repo.name}')" class="action-btn">Details</button>
                    `;
                    cardsContainer.appendChild(card);
                });

                if (reposInCategory.length === 0) {
                    cardsContainer.innerHTML = `<p style="color: var(--text-tertiary); text-align: center;">No projects</p>`;
                }

                column.appendChild(cardsContainer);
                kanban.appendChild(column);
            });

            container.appendChild(kanban);
        }

        function renderProfileAnalytics() {
            const container = document.getElementById('profile-analytics');
            container.innerHTML = '';

            const totalRepos = githubData.repos.length;
            const languageCounts = githubData.repos.reduce((acc, repo) => {
                if (repo.language) acc[repo.language] = (acc[repo.language] || 0) + 1;
                return acc;
            }, {});
            const totalStars = githubData.repos.reduce((acc, repo) => acc + repo.stargazers_count, 0);
            const totalForks = githubData.repos.reduce((acc, repo) => acc + repo.forks_count, 0);

            container.innerHTML = `
                <div class="analytics">
                    <div class="analytics-card" title="Total number of repositories">
                        <div class="analytics-number">${totalRepos}</div>
                        <div class="analytics-label">Total Repos</div>
                    </div>
                    <div class="analytics-card" title="Total stars across all repositories">
                        <div class="analytics-number">${totalStars}</div>
                        <div class="analytics-label">Total Stars</div>
                    </div>
                    <div class="analytics-card" title="Total forks across all repositories">
                        <div class="analytics-number">${totalForks}</div>
                        <div class="analytics-label">Total Forks</div>
                    </div>
                </div>
                <h3 class="mt-4">Repositories by Language</h3>
                <div class="chart-container">
                    <canvas id="language-chart"></canvas>
                </div>
                <h3 class="mt-4">Repositories Created per Month</h3>
                <div class="chart-container">
                    <canvas id="repos-per-month-chart"></canvas>
                </div>
            `;

            const languageData = {
                labels: Object.keys(languageCounts),
                datasets: [{
                    data: Object.values(languageCounts),
                    backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF', '#FF9F40'],
                }]
            };
            const languageCtx = document.getElementById('language-chart').getContext('2d');
            if (window.languageChart) window.languageChart.destroy();
            window.languageChart = new Chart(languageCtx, {
                type: 'pie',
                data: languageData,
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: getComputedStyle(document.documentElement).getPropertyValue('--text-primary')
                            }
                        }
                    }
                }
            });

            const reposPerMonth = githubData.repos.reduce((acc, repo) => {
                const month = new Date(repo.created_at).toLocaleString('default', { month: 'short', year: 'numeric' });
                acc[month] = (acc[month] || 0) + 1;
                return acc;
            }, {});
            const months = Object.keys(reposPerMonth).sort((a, b) => new Date(a) - new Date(b));
            const reposPerMonthData = {
                labels: months,
                datasets: [{
                    label: 'Repositories Created',
                    data: months.map(month => reposPerMonth[month]),
                    backgroundColor: 'rgba(0, 240, 255, 0.2)',
                    borderColor: 'rgba(0, 240, 255, 1)',
                    borderWidth: 1,
                }]
            };
            const reposPerMonthCtx = document.getElementById('repos-per-month-chart').getContext('2d');
            if (window.reposPerMonthChart) window.reposPerMonthChart.destroy();
            window.reposPerMonthChart = new Chart(reposPerMonthCtx, {
                type: 'bar',
                data: reposPerMonthData,
                options: {
                    responsive: true,
                    scales: {
                        y: { beginAtZero: true, ticks: { color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary') }, grid: { color: 'rgba(255, 255, 255, 0.05)' } },
                        x: { ticks: { color: getComputedStyle(document.documentElement).getPropertyValue('--text-secondary') }, grid: { color: 'rgba(255, 255, 255, 0.05)' } }
                    },
                    plugins: { legend: { labels: { color: getComputedStyle(document.documentElement).getPropertyValue('--text-primary') } } }
                }
            });
        }

        function openProjectDetails(repoName) {
            const repo = githubData.repos.find(r => r.name === repoName);
            if (repo) {
                const container = document.getElementById('project-details-content');
                container.innerHTML = `
                    <p><strong>Name:</strong> ${repo.name}</p>
                    <p><strong>Description:</strong> ${repo.description || 'N/A'}</p>
                    <p><strong>Language:</strong> ${repo.language || 'N/A'}</p>
                    <p><strong>Stars:</strong> ${repo.stargazers_count}</p>
                    <p><strong>Forks:</strong> ${repo.forks_count}</p>
                    <p><strong>Last Updated:</strong> ${formatDate(repo.updated_at)}</p>
                    <p><strong>Commits:</strong> 100 (placeholder)</p>
                    <p><strong>Contributors:</strong> 5 (placeholder)</p>
                    <p><strong>Open Issues:</strong> ${repo.open_issues_count}</p>
                    <p><strong>Open Pull Requests:</strong> 2 (placeholder)</p>
                    <p><strong>URL:</strong> <a href="${repo.html_url}" target="_blank">View on GitHub</a></p>
                    <button onclick="openProjectAnalytics('${repo.name}')" class="btn-primary">View Analytics</button>
                `;
                openModal('project-details-modal');
            }
        }

        function openProjectAnalytics(repoName) {
            const repo = githubData.repos.find(r => r.name === repoName);
            if (repo) {
                const container = document.getElementById('project-analytics-content');
                container.innerHTML = `
                    <p>Analytics for <strong>${repo.name}</strong></p>
                    <p>Stars: ${repo.stargazers_count}</p>
                    <p>Forks: ${repo.forks_count}</p>
                    <p>Watchers: ${repo.watchers_count}</p>
                    <p>Open Issues: ${repo.open_issues_count}</p>
                `;
                openModal('project-analytics-modal');
            }
        }

        // Real-time Filtering for Projects
        document.querySelectorAll('#projects-table-view .filter-inputs input').forEach(input => {
            input.addEventListener('input', () => {
                if (!isProjectsKanbanView) renderProjectsTable();
            });
        });
    </script>
</body>

</html>
